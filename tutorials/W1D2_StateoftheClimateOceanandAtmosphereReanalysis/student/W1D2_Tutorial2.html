
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 2: A lot of weather makes climate - exploring the ERA5 Reanalysis — Climatematch Academy: Computational Climate Science</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/custom.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<link href="../../../genindex.html" rel="index" title="Index">
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W1D2_Tutorial3.html" rel="next" title="Tutorial 3: Atmospheric wind driven circulation"/>
<link href="W1D2_Tutorial1.html" rel="prev" title="Calculating ENSO with Xarray"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<h1 class="site-logo" id="site-title">Climatematch Academy: Computational Climate Science</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_jupyterhub.html">
<strong>
        Using JupyterHub
       </strong>
</a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using discord
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Fundamentals
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/chapter_title.html">
   Climate System Overview (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial1.html">
<strong>
      Tutorial 1: Creating DataArrays and Datasets to Assess Global Climate Data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial2.html">
<strong>
      Tutorial 2: Selection, Interpolation and Slicing
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial3.html">
<strong>
      Tutorial 3: Opening and Plotting netCDF Data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial4.html">
<strong>
      Tutorial 4: Arithmetic and Aggregation Methods
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial5.html">
<strong>
      Tutorial 5: Xarray Data Analysis and Climatology
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial6.html">
<strong>
      Tutorial 6: Compute and Plot Temperature Anomalies
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial7.html">
<strong>
      Tutorial 7: Other Computational Tools in Xarray
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial8.html">
<strong>
      Tutorial 8: Masking with One Condition
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial9.html">
<strong>
      Tutorial 9: Masking with Multiple Conditions
     </strong>
</a>
</li>
</ul>
</input></li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/chapter_title.html">
   Good Research Practices (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial1.html">
<strong>
      Tutorial 1: Finding a Phenomenon and Asking a Question About It
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial2.html">
<strong>
      Tutorial 2: Doing a Literature Review
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial3.html">
<strong>
      Tutorial 3: Identifying the Basic Ingredients
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial4.html">
<strong>
      Tutorial 4: Formulating a Hypothesis
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial5.html">
<strong>
      Tutorial 5: Drafting the Analysis
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial6.html">
<strong>
      Tutorial 6: Implementing the Analysis
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial7.html">
<strong>
      Tutorial 7: Interpreting the Results
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial8.html">
<strong>
      Tutorial 8: Communicating Your Conclusions
     </strong>
</a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Climate Data
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   State of the Climate Ocean and Atmosphere Reanalysis (W1D2)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="W1D2_Tutorial1.html">
     Calculating ENSO with Xarray
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Tutorial 2: A lot of weather makes climate - exploring the ERA5 Reanalysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W1D2_Tutorial3.html">
     Tutorial 3: Atmospheric wind driven circulation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W1D2_Tutorial4.html">
     Tutorial 4: Ocean wind driven circulation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W1D2_Tutorial5.html">
     Tutorial 5: Thermohaline circulation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W1D2_Tutorial6.html">
     Tutorial 6: Ocean heat content
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/chapter_title.html">
   Remote Sensing Land Ocean and Atmosphere (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial1.html">
     Video 1: What is Remote Sensing
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial2.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial3.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial4.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial5.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial6.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial7.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial8.html">
     Figure settings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_Paleoclimate/chapter_title.html">
   Paleoclimate (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial1.html">
<strong>
      Tutorial 1: Paleoclimate Proxies
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial2.html">
<strong>
      Tutorial 2: Reconstructing Past Changes in Ocean Climate
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial3.html">
<strong>
      Tutorial 3: Reconstructing Past Changes in Terrestrial Climate
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial4.html">
<strong>
      Tutorial 4: Reconstructing Past Changes in Atmospheric Climate
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial5.html">
<strong>
      Tutorial 5: Paleoclimate Data Analysis Tools
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial6.html">
<strong>
      Tutorial 6: Spectral Analysis of Paleoclimate Data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial7.html">
<strong>
      Tutorial 7: Assessing Climate Forcings
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial8.html">
<strong>
      Tutorial 8: Paleoclimate Models
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial9.html">
<strong>
      Tutorial 9: Paleoclimate Reanalysis Products
     </strong>
</a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Climate Future
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_ClimateModeling/chapter_title.html">
   Climate Modeling (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial1.html">
<strong>
      Tutorial 1 : A Simple Greenhouse Model
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial2.html">
     Setup
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial3.html">
     Setup
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial4.html">
     Setup
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial5.html">
<strong>
      Tutorial 5: Radiative Equilibrium
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial6.html">
<strong>
      Tutorial 6: Radiative Convective Equilibrium
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial7.html">
<strong>
      Tutorial 7: Introduction to Earth System Models
     </strong>
</a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/chapter_title.html">
   Future Climate - IPCC I Physical Basis (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial1.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial2.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial3.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial4.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial5.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial6.html">
     Figure settings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/chapter_title.html">
   Future Climate - IPCC II &amp; III Socio-Economic Basis (W2D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/student/W2D3_Tutorial1.html">
<strong>
      Tutorial Objectives
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/student/W2D3_Tutorial2.html">
<strong>
      Tutorial 2: Transition Goals and Integrated Assessment Models
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/student/W2D3_Tutorial4.html">
<strong>
      Tutorial 4: Public Opinion on the Climate Emergency and Why it Matters
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/further_reading.html">
<strong>
      Tutorial 2 Further Reading
     </strong>
</a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Climate Response
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/chapter_title.html">
   Climate Response - Adaptation Impact (W2D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial1.html">
<strong>
      Tutorial 1: Linear and Logistic Regression
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial2.html">
<strong>
      Tutorial 2:  Regression and Decision Trees on the Dengue Fever Dataset
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial3.html">
<strong>
      Tutorial 3:  Logistic Regression and ANN on the Remote Sensing Crop Dataset
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial4.html">
<strong>
      Tutorial 4:  Exploring other applications
     </strong>
</a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/datasets_overview.html">
   Project materials
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Sea_level_rise.html">
<strong>
      Sea level rise
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Ocean_acidification.html">
<strong>
      Ocean acidification
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/ENSO_impact_on_precipitation_and_temperature.html">
<strong>
      The impact of ENSO on precipitation and temperature
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Regional_precipitation_variability.html">
     Regional precipitation variability and extreme events
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Heatwaves.html">
<strong>
      Heatwaves: Assessing the dynamic interactions of the atmosphere and land
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Wildfires_and_burnt_areas.html">
<strong>
      Monitoring and mapping wildfires using satellite data
     </strong>
</a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/continuing_your_project_after_the_course.html">
   Continuing your project after the course
  </a>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://climatematch.2i2c.cloud/hub/user-redirect/git-pull?repo=https%3A//github.com/ClimatematchAcademy/course-content&amp;urlpath=lab/tree/course-content/book/tutorials/W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial2.ipynb&amp;branch=main" title="Launch on JupyterHub">
<span class="headerbtn__icon-container">
<img src="../../../_static/images/logo_jupyterhub.svg"/>
</span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>
</li>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/ClimatematchAcademy/course-content" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/ClimatematchAcademy/course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial2.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial2.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 2: A lot of weather makes climate - exploring the ERA5 Reanalysis
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-slides">
     Tutorial slides
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
       Tutorial slides
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
         Tutorial slides
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
           Tutorial slides
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
             Tutorial slides
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id5">
       Figure settings
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id6">
         Figure settings
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id7">
           Figure settings
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id8">
             Figure settings
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting functions
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id9">
       Plotting functions
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id10">
         Plotting functions
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id11">
           Plotting functions
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id12">
             Plotting functions
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id13">
       Helper functions
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id14">
         Helper functions
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id15">
           Helper functions
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id16">
             Helper functions
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#introduction-what-are-reanalysis-data">
     Introduction: What are Reanalysis data?
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#part-i-accessing-era5-data">
     Part I: Accessing ERA5 data
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#part-ii-selecting-regions-and-plotting-data">
     Part II: Selecting regions and plotting data
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#note-about-the-geographic-coordinate-system-and-the-coodinates-used-in-this-data-set">
       Note about the geographic coordinate system and the coodinates used in this data set:
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#part-iii-plotting-spatial-maps">
     Part III: Plotting spatial maps
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#making-a-first-plot">
       1. Making a first plot
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise">
<em>
        Exercise:
       </em>
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#synoptic-variabilty">
       2. Synoptic Variabilty
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id17">
       Exercise:
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#durinal-cycle-coastel-clouds-at-the-coast-on-a-sunny-day">
       3. Durinal cycle - Coastel clouds at the coast on a sunny day?
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#discussion-questions">
<em>
        Discussion Questions:
       </em>
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#short-answers">
         short answers:
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#part-4-another-way-to-look-at-variabilty-creating-time-series">
     Part 4: Another way to look at variabilty: Creating time series
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#questions">
<em>
        Questions
       </em>
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id18">
<em>
      Exercise
     </em>
     :
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id19">
<em>
      Questions
     </em>
     :
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-extending-the-timeseries-analysis-to-long-timeperiods">
   Bonus: Extending the timeseries analysis to long timeperiods
  </a>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 2: A lot of weather makes climate - exploring the ERA5 Reanalysis</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 2: A lot of weather makes climate - exploring the ERA5 Reanalysis
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-slides">
     Tutorial slides
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
       Tutorial slides
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
         Tutorial slides
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
           Tutorial slides
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
             Tutorial slides
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure settings
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id5">
       Figure settings
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id6">
         Figure settings
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id7">
           Figure settings
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id8">
             Figure settings
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting-functions">
     Plotting functions
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id9">
       Plotting functions
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id10">
         Plotting functions
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id11">
           Plotting functions
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id12">
             Plotting functions
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id13">
       Helper functions
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id14">
         Helper functions
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id15">
           Helper functions
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id16">
             Helper functions
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#introduction-what-are-reanalysis-data">
     Introduction: What are Reanalysis data?
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#part-i-accessing-era5-data">
     Part I: Accessing ERA5 data
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#part-ii-selecting-regions-and-plotting-data">
     Part II: Selecting regions and plotting data
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#note-about-the-geographic-coordinate-system-and-the-coodinates-used-in-this-data-set">
       Note about the geographic coordinate system and the coodinates used in this data set:
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#part-iii-plotting-spatial-maps">
     Part III: Plotting spatial maps
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#making-a-first-plot">
       1. Making a first plot
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise">
<em>
        Exercise:
       </em>
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#synoptic-variabilty">
       2. Synoptic Variabilty
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id17">
       Exercise:
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#durinal-cycle-coastel-clouds-at-the-coast-on-a-sunny-day">
       3. Durinal cycle - Coastel clouds at the coast on a sunny day?
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#discussion-questions">
<em>
        Discussion Questions:
       </em>
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#short-answers">
         short answers:
        </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#part-4-another-way-to-look-at-variabilty-creating-time-series">
     Part 4: Another way to look at variabilty: Creating time series
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#questions">
<em>
        Questions
       </em>
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id18">
<em>
      Exercise
     </em>
     :
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id19">
<em>
      Questions
     </em>
     :
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-extending-the-timeseries-analysis-to-long-timeperiods">
   Bonus: Extending the timeseries analysis to long timeperiods
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<div class="section" id="tutorial-2-a-lot-of-weather-makes-climate-exploring-the-era5-reanalysis">
<h1>Tutorial 2: A lot of weather makes climate - exploring the ERA5 Reanalysis<a class="headerlink" href="#tutorial-2-a-lot-of-weather-makes-climate-exploring-the-era5-reanalysis" title="Permalink to this headline">¶</a></h1>
<p>**Week 1, Day 2(?): Introduce atmospheric reanalysis (ERA5) **</p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Hell, Momme, Name Surname, Day Lead’s Name</p>
<p><strong>Content reviewers:</strong> Name Surname, Name Surname</p>
<p><strong>Content editors:</strong> Name Surname, Name Surname</p>
<p><strong>Production editors:</strong> Name Surname, Name Surname</p>
<p><strong>Our 2023 Sponsors</strong></p>
<!-- <p align='center'><img src='https://github.com/NeuromatchAcademy/widgets/blob/master/sponsors.png?raw=True'/></p> --><hr class="docutils"/>
<p>#<strong>Tutorial Objectives</strong></p>
<p>In the previous section we learned about ENSO, which as an atmosphere-ocean dynamical phenomena. We will now examine the atmosphere and the ocean systems more generally.</p>
<p>In this tutorial you will learn how to handle reanalysis data and how they derive weather and climate varaivles of interest. We will begin with two ways to access the ECMWF ERA5 renalysis, either through Poodac, or alternatively through the web copernicus api. You will learn how to pick and mask a region on interest, and see how important climate variables will change within on short timescales between days, months.</p>
<p>By the end of this tutorial you will be able to:</p>
<ul class="simple">
<li><p>a) access and select reanalysis data of interest</p></li>
<li><p>b) plot variables so that you can see changes in on different time scales.</p></li>
<li><p>c) derive timeseries of these variables.</p></li>
</ul>
<div class="section" id="tutorial-slides">
<h2>Tutorial slides<a class="headerlink" href="#tutorial-slides" title="Permalink to this headline">¶</a></h2>
<p>These are the slides for the videos in all tutorials today</p>
<div class="section" id="id1">
<h3>Tutorial slides<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>These are the slides for the videos in all tutorials today</p>
<div class="section" id="id2">
<h4>Tutorial slides<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>These are the slides for the videos in all tutorials today</p>
<div class="section" id="id3">
<h5>Tutorial slides<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<p>These are the slides for the videos in all tutorials today</p>
<div class="section" id="id4">
<h6>Tutorial slides<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h6>
<p>These are the slides for the videos in all tutorials today</p>
<p>#######  Tutorial slides</p>
<p>These are the slides for the videos in all tutorials today</p>
<p>########  Tutorial slides</p>
<p>These are the slides for the videos in all tutorials today</p>
<p>#########  Tutorial slides</p>
<p>These are the slides for the videos in all tutorials today</p>
<p>##########  Tutorial slides</p>
<p>These are the slides for the videos in all tutorials today</p>
<p>###########  Tutorial slides</p>
<p>These are the slides for the videos in all tutorials today</p>
<p>############  Tutorial slides</p>
<p>These are the slides for the videos in all tutorials today</p>
<p>#############  Tutorial slides</p>
<p>These are the slides for the videos in all tutorials today</p>
<p>##############  Tutorial slides</p>
<p>These are the slides for the videos in all tutorials today</p>
<p>###############  Tutorial slides</p>
<p>These are the slides for the videos in all tutorials today</p>
<p>################  Tutorial slides</p>
<p>These are the slides for the videos in all tutorials today</p>
<p>#################  Tutorial slides</p>
<p>These are the slides for the videos in all tutorials today</p>
<div class="cell tag_remove-input docutils container">
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<p>In this section, we have:</p>
<ol class="simple">
<li><p><strong>Import cell</strong>: imports all libraries you use in the tutorial.</p></li>
<li><p><strong>Hidden Figure settings cell</strong>: sets up the plotting style (copy exactly).</p></li>
<li><p><strong>Hidden Plotting functions cell</strong>: contains all functions used to create plots throughout the tutorial (so students don’t waste time looking at boilerplate matplotlib but can here if they wish to). Please use only matplotlib for plotting for consistency.</p></li>
<li><p><strong>Hidden Helper functions cell</strong>: This should contain functions that students have previously used or that are very simple. Any helper functions that are being used for the first time and are important should be placed directly above the relevant text or exercise (see Section 1.1 for an example).</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">intake</span> <span class="kn">import</span> <span class="n">open_catalog</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">cartopy</span> <span class="kn">import</span> <span class="n">crs</span> <span class="k">as</span> <span class="n">ccrs</span><span class="p">,</span> <span class="n">feature</span> <span class="k">as</span> <span class="n">cfeature</span>
<span class="c1">#  Suppress warnings issued by Cartopy when downloading data files</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id5">
<h3>Figure settings<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id6">
<h4>Figure settings<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id7">
<h5>Figure settings<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h5>
<div class="section" id="id8">
<h6>Figure settings<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h6>
<p>#######  Figure settings</p>
<p>########  Figure settings</p>
<p>#########  Figure settings</p>
<p>##########  Figure settings</p>
<p>###########  Figure settings</p>
<p>############  Figure settings</p>
<p>#############  Figure settings</p>
<p>##############  Figure settings</p>
<p>###############  Figure settings</p>
<p>################  Figure settings</p>
<p>#################  Figure settings</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>       <span class="c1"># interactive display</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/ClimateMatchAcademy/course-content/main/cma.mplstyle"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">font_for_print</span><span class="p">():</span>

    <span class="n">SMALL_SIZE</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">MEDIUM_SIZE</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">BIGGER_SIZE</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">legend_properties</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'weight'</span><span class="p">:</span><span class="s1">'bold'</span><span class="p">}</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'font'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">SMALL_SIZE</span><span class="p">,</span> <span class="n">serif</span><span class="o">=</span><span class="s1">'Helvetica Neue'</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">'normal'</span><span class="p">)</span>          <span class="c1"># controls default text sizes</span>
    <span class="c1">#plt.rc('font', size=SMALL_SIZE, serif='DejaVu Sans', weight='light')</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'text'</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="s1">'false'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'axes'</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="n">MEDIUM_SIZE</span><span class="p">,</span> <span class="n">labelweight</span><span class="o">=</span><span class="s1">'normal'</span><span class="p">)</span>     <span class="c1"># fontsize of the axes title</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'axes'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">SMALL_SIZE</span><span class="p">,</span> <span class="n">labelweight</span><span class="o">=</span><span class="s1">'normal'</span><span class="p">)</span> <span class="c1">#, family='bold')    # fontsize of the x and y labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'xtick'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">SMALL_SIZE</span><span class="p">)</span>    <span class="c1"># fontsize of the tick labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'ytick'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">SMALL_SIZE</span><span class="p">)</span>    <span class="c1"># fontsize of the tick labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'legend'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">SMALL_SIZE</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>    <span class="c1"># legend fontsize</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'figure'</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="n">MEDIUM_SIZE</span><span class="p">,</span> <span class="n">titleweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">,</span> <span class="n">autolayout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#, family='bold')  # fontsize of the figure title</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">'axes'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span> <span class="n">SMALL_SIZE</span><span class="p">,</span> <span class="n">labelweight</span><span class="o">=</span><span class="s1">'normal'</span><span class="p">)</span>

<span class="n">font_for_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-functions">
<h2>Plotting functions<a class="headerlink" href="#plotting-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id9">
<h3>Plotting functions<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id10">
<h4>Plotting functions<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id11">
<h5>Plotting functions<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h5>
<div class="section" id="id12">
<h6>Plotting functions<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h6>
<p>#######  Plotting functions</p>
<p>########  Plotting functions</p>
<p>#########  Plotting functions</p>
<p>##########  Plotting functions</p>
<p>###########  Plotting functions</p>
<p>############  Plotting functions</p>
<p>#############  Plotting functions</p>
<p>##############  Plotting functions</p>
<p>###############  Plotting functions</p>
<p>################  Plotting functions</p>
<p>#################  Plotting functions</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plotting functions</span>

<span class="k">def</span> <span class="nf">format_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAKES</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'None'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span> <span class="p">)</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span>  <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">ylabels_left</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1">#gl.xlines = False</span>

<span class="k">def</span> <span class="nf">plot_variable_Facet</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">time_dim</span> <span class="o">=</span> <span class="s2">"time"</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="n">time_dim</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="s2">"too many time steps selected, please select less then 6"</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span> <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">cmap</span>

    <span class="n">data_sel_plot</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">aspect</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
        <span class="n">col</span><span class="o">=</span><span class="n">time_dim</span><span class="p">,</span>
        <span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">"projection"</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Orthographic</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">35</span><span class="p">)},</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
        <span class="n">add_colorbar</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#,col_wrap=1 )</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">data_sel_plot</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">format_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title_name</span><span class="o">=</span> <span class="n">title</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">title_name</span> <span class="o">=</span> <span class="n">ERA5_durinal_cycle</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">'long_name'</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">title_name</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">pass</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title_name</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.01</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data_sel_plot</span>

<span class="k">def</span> <span class="nf">cbar_label</span><span class="p">(</span><span class="n">DD</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">DD</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">'long_name'</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' ['</span> <span class="o">+</span> <span class="n">DD</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">'units'</span><span class="p">]</span><span class="o">+</span> <span class="s1">']'</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id13">
<h3>Helper functions<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id14">
<h4>Helper functions<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id15">
<h5>Helper functions<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h5>
<div class="section" id="id16">
<h6>Helper functions<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h6>
<p>#######  Helper functions</p>
<p>########  Helper functions</p>
<p>#########  Helper functions</p>
<p>##########  Helper functions</p>
<p>###########  Helper functions</p>
<p>############  Helper functions</p>
<p>#############  Helper functions</p>
<p>##############  Helper functions</p>
<p>###############  Helper functions</p>
<p>################  Helper functions</p>
<p>#################  Helper functions</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>

<span class="k">def</span> <span class="nf">set_region_figure</span><span class="p">(</span><span class="n">lon_range</span><span class="p">,</span> <span class="n">lat_range</span><span class="p">,</span> <span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">figsize</span> <span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span> <span class="p">):</span>
    <span class="c1"># source:https://foundations.projectpythia.org/core/cartopy/cartopy.html</span>

    <span class="n">lonE</span><span class="p">,</span> <span class="n">lonW</span> <span class="o">=</span> <span class="n">lon_range</span>
    <span class="n">latN</span><span class="p">,</span> <span class="n">latS</span> <span class="o">=</span> <span class="n">lat_range</span>

    <span class="n">cLat</span> <span class="o">=</span> <span class="p">(</span><span class="n">latN</span> <span class="o">+</span> <span class="n">latS</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">cLon</span> <span class="o">=</span> <span class="p">(</span><span class="n">lonW</span> <span class="o">+</span> <span class="n">lonE</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">projLccNY</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">LambertConformal</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">cLon</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="n">cLat</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projLccNY</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lonW</span><span class="p">,</span> <span class="n">lonE</span><span class="p">,</span> <span class="n">latS</span><span class="p">,</span> <span class="n">latN</span><span class="p">])</span><span class="c1">#, crs=projPC)</span>

    <span class="c1">#ax.set_facecolor(cfeature.COLORS['water'])</span>
    <span class="c1">#ax.add_feature(cfeature.LAND)</span>
    <span class="c1">#ax.add_feature(cfeature.COASTLINE)</span>
    <span class="c1">#ax.add_feature(cfeature.BORDERS, linestyle='--')</span>

    <span class="c1">#ax.add_feature(cfeature.NaturalEarthFeature('physical', 'land', '50m', edgecolor='black', alpha = 0.2, facecolor='gray'))</span>
    <span class="c1">#ax.add_feature(cfeature.LAKES, facecolor='white', alpha=0.5 )</span>

    <span class="c1"># gl = ax.gridlines(</span>
    <span class="c1">#     draw_labels=True, linewidth=1, color='black', alpha=0.5, linestyle='--'</span>
    <span class="c1"># )</span>

    <span class="n">format_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="c1">#ax.add_feature(cfeature.STATES)</span>
    <span class="c1">#ax.add_feature(cfeature.RIVERS)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

<span class="k">def</span> <span class="nf">get_time_compared_to_UTC</span><span class="p">(</span><span class="n">longitude</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Converts a longitude value to the corresponding local time and offset from UTC.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    longitude (float): The longitude value in degrees.</span>

<span class="sd">    Returns:</span>
<span class="sd">    numpy.datetime64: The current local time at the given longitude.</span>
<span class="sd">    datetime.timedelta: The offset from UTC in hours and minutes.</span>
<span class="sd">    """</span>
    <span class="c1"># Calculate the time offset from UTC based on the longitude</span>
    <span class="n">offset_hours</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">longitude</span> <span class="o">/</span> <span class="mi">15</span><span class="p">)</span>
    <span class="n">offset_minutes</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">longitude</span> <span class="o">/</span> <span class="mi">15</span> <span class="o">-</span> <span class="n">offset_hours</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="n">offset_hours</span><span class="p">,</span> <span class="s1">'h'</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="n">offset_minutes</span><span class="p">,</span> <span class="s1">'m'</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">offset</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'m8[h]'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="introduction-what-are-reanalysis-data">
<h2>Introduction: What are Reanalysis data?<a class="headerlink" href="#introduction-what-are-reanalysis-data" title="Permalink to this headline">¶</a></h2>
<p>We know that earth is warming. But how do we know that, and how do we know how that changes weather and climate? These are very hard questions, but thanks to work of many scientist, we now have data that allows to pick at any place of the planet and look how weather and cliamte has changes since 1979. This data is called <strong>Reanalysis data</strong>, and refers to the process of combining historical observations from a variety of sources, such as weather stations, satellites, and buoys, with numerical models to create a comprehensive and consistent record of past weather and climate conditions. Reanalysis data is then used to study the Earth’s climate system over a wide range of time scales, from seasonal to decadal to century-scale changes. By providing a complete picture of the Earth’s climate history, reanalysis data is great tool to understand the causes and effects of climate change.</p>
<p><a class="reference external" href="https://climate.copernicus.eu/climate-reanalysis">This video</a> from the European Centre for Medium-Range Weather Forecasts (ECMWF) provides you with a brief introdution about their reanalysis, called <strong>ERA5</strong>. Note that there is not one reanalysis product that that fits all needs, such that there are many earth reanalysis like MERRA-2, NCEP-NCAR, JRA-55C, and many others <a class="reference external" href="https://climatedataguide.ucar.edu/climate-data/atmospheric-reanalysis-overview-comparison-tables">see extensive list here</a></p>
</div>
<div class="section" id="part-i-accessing-era5-data">
<h2>Part I: Accessing ERA5 data<a class="headerlink" href="#part-i-accessing-era5-data" title="Permalink to this headline">¶</a></h2>
<p>For this tutorial we stick with ERA5.
There are multiple way to accesss ERA5 data. You can browse the <a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#%21/search?text=ERA5%20back%20extension&amp;type=dataset">Copernicus ERA5 storage</a>, use the <a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to">copernicus client</a>, or the <a class="reference external" href="https://era5cli.readthedocs.io/en/stable/">era5cli package</a>. Here are futher instruction <a class="reference external" href="https://towardsdatascience.com/read-era5-directly-into-memory-with-python-511a2740bba0">how to use it directly in your jupyter notebook</a>.</p>
<p>However, for the this tutorial we will access the data through the pangeo cloud storage. For that we just need the link to the atmosphere catalog at pangeo and the correct string to select the product:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># not needed/nor working in stand-alone version</span>
<span class="c1"># cat = open_catalog("https://raw.githubusercontent.com/pangeo-data/pangeo-datastore/master/intake-catalogs/atmosphere.yaml")</span>
<span class="c1"># ERA5  = cat["era5_hourly_reanalysis_single_levels_sa"].to_dask()</span>
<span class="c1"># ERA5</span>
</pre></div>
</div>
</div>
</div>
<p>You can see the available variables here if you like</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># not needed/nor working in stand-alone version</span>
<span class="c1"># for k in list(set(ERA5.variables.keys()) - set(ERA5.coords.keys()) ) :</span>
<span class="c1">#     print('variable name:' , k, ':')</span>
<span class="c1">#     print('long name:' ,ERA5[k].attrs['long_name'])</span>
<span class="c1">#     print('units:', ERA5[k].attrs['units'] )</span>
<span class="c1">#     print('--------')</span>
</pre></div>
</div>
</div>
</div>
<p>You see here an xarray dataset as introduced at the first day, with its coordinates and 17 variables covering the whole globe (-90 to +90 degrees in latitude, 0 to 360 degrees on longitude) and 30 years from 1979 to 2018. With this dataser you have access to our best guesses of variables on the earth surface with a spatial resolution 1/4 degree, that means each grid point represents about 25 km x 25 km, and a temporal resolution of 1 hour (!). That is a lot of data, but still just a fraction the data available trough the ERA5 web api (LINK). See the end of the tutorial for more information which variables are available.</p>
</div>
<div class="section" id="part-ii-selecting-regions-and-plotting-data">
<h2>Part II: Selecting regions and plotting data<a class="headerlink" href="#part-ii-selecting-regions-and-plotting-data" title="Permalink to this headline">¶</a></h2>
<p>Because the available data is so large, infact certainly too large to store it on your computer, we here just use subsets of this data to illustrate its use. Select one of the regions below to work with.</p>
<p>Alternatively you can also define your own region (where you live for example), eventhough coastal regions work best for this exercise. For that please define a longitude and latitude range of a size between 10 and 50 degrees of a coastal region.
To find the longitude and latitude coodinates of your region, you can use <a class="reference external" href="https://earth.google.com/">google earth view</a>, and read the position of your cursor in lower right corner.</p>
<div class="section" id="note-about-the-geographic-coordinate-system-and-the-coodinates-used-in-this-data-set">
<h3>Note about the geographic coordinate system and the coodinates used in this data set:<a class="headerlink" href="#note-about-the-geographic-coordinate-system-and-the-coodinates-used-in-this-data-set" title="Permalink to this headline">¶</a></h3>
<p>A point on earth is reference in latitude-longitude coodinates relative to the zero meridian going through the Greenwich UK (longitude = 0 degree) and the equator (latitude = 0 degrees). That means points east of Greenwich up to the dateline on the other side of the globe are referencedas 0 to +180 and point to the west are 0 to -180. -180 and +180 refer to the same longitude, the so called “dateline” in the central pacific. However, Our data is referenced in an alternative way: Starting at the dateline, at 180 degrees longitude and then counting eastward to 360.
The conversion between both reference systems is given in the fuctions below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># helping functions:</span>
<span class="k">def</span> <span class="nf">geographic_lon_to_360</span><span class="p">(</span><span class="n">lon</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">360</span> <span class="o">+</span> <span class="n">lon</span>

<span class="k">def</span> <span class="nf">inverted_geographic_lon_to_360</span><span class="p">(</span><span class="n">lon</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">lon</span> <span class="o">-</span> <span class="mi">180</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note I: The order of range has to follow the convention of the data set.</span>
<span class="c1"># For this dataset, the longitude range goes from 0 to 360 degrees and</span>
<span class="c1"># the latitude range from 90 degrees North to 90 South.</span>

<span class="c1">## Regions:</span>

<span class="c1"># North eastern United States</span>
<span class="n">lat_range</span> <span class="o">=</span> <span class="p">[</span><span class="mf">55.2</span><span class="p">,</span> <span class="mf">30.2</span><span class="p">]</span> <span class="c1"># From north to south</span>
<span class="n">lon_range</span> <span class="o">=</span> <span class="p">[</span><span class="n">geographic_lon_to_360</span><span class="p">(</span><span class="o">-</span><span class="mf">90.0</span><span class="p">),</span> <span class="n">geographic_lon_to_360</span><span class="p">(</span><span class="o">-</span><span class="mi">65</span><span class="p">)]</span> <span class="c1"># from west to east</span>

<span class="c1"># Coast of Brazil</span>

<span class="c1"># Coast western Africa</span>

<span class="c1"># Coast South Andes</span>

<span class="c1"># Coast of India</span>

<span class="c1"># Coast of South East Asia</span>

<span class="c1"># !!! add more examples here</span>
</pre></div>
</div>
</div>
</div>
<p>next select a year and month that you want to work with. We recommend using a spring or summer month in the respective hemisphere:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### for pangeo access:</span>
<span class="c1"># date = '2018-03'</span>

<span class="c1"># # select the longitude-latitude box</span>
<span class="c1"># ERA5_select = ERA5.sel(longitude= slice(lon_range[0] , lon_range[1])).sel(latitude = slice(lat_range[0] , lat_range[1]))</span>

<span class="c1"># # select the month and the 3 variables we are intersted in</span>
<span class="c1"># ERA5_select = ERA5_select.sel(time =date)[['t2m', 'u10', 'v10', 'tcc']]</span>
<span class="c1"># #ERA5_select = ERA5_select.isel(time =slice(0, 72))</span>

<span class="c1">### stand-alone version:</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="n">ERA5_select</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">'ERA5_select_example.nc'</span><span class="p">)</span>
<span class="n">ERA5_select</span>
</pre></div>
</div>
</div>
</div>
<p>Now lets plot data in this selected month. To understand the variable of the data we do that in 3 three different ways.</p>
<ol class="simple">
<li><p>Durinal cycle: We plot the mean of the 2-meter temperature, cloud cover, and surface wind speed at 0,6,12,18h of the local time (!)</p></li>
<li><p>Synoptic variability: We plot the same variables at noon local time every 5th day.</p></li>
<li><p>Monthly climatology: we plot the monthly climatology of the same variables</p></li>
</ol>
<p>To get he surface wind speed we need to combine the zonald and meridional wind to an new variable “u_speed” in the data set:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ERA5_select</span><span class="p">[</span><span class="s1">'u_speed'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ERA5_select</span><span class="p">[</span><span class="s1">'u10'</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ERA5_select</span><span class="p">[</span><span class="s1">'v10'</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># for having the right name and units in the DataArray:</span>
<span class="n">ERA5_select</span><span class="p">[</span><span class="s1">'u_speed'</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">'long_name'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"10-meter wind speed"</span>
<span class="n">ERA5_select</span><span class="p">[</span><span class="s1">'u_speed'</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">'units'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"m/s"</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="part-iii-plotting-spatial-maps">
<h2>Part III: Plotting spatial maps<a class="headerlink" href="#part-iii-plotting-spatial-maps" title="Permalink to this headline">¶</a></h2>
<div class="section" id="making-a-first-plot">
<h3>1. Making a first plot<a class="headerlink" href="#making-a-first-plot" title="Permalink to this headline">¶</a></h3>
<p>Let plot some data! Pick any day wihtin the month you selected before and plot the 2-meter temperature, the wind speed and the total cloud cover.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">=</span> <span class="s2">"2018-03"</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ERA5_one_day = ERA5_select.isel(time = 29)</span>
<span class="c1"># or alternatively, you can speficy the data of the day</span>
<span class="n">day_string</span> <span class="o">=</span> <span class="n">date</span> <span class="o">+</span><span class="s1">'-02'</span>
<span class="n">ERA5_one_day</span> <span class="o">=</span> <span class="n">ERA5_select</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">day_string</span> <span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">'time'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span>  <span class="p">[</span><span class="s1">'t2m'</span><span class="p">,</span> <span class="s1">'tcc'</span><span class="p">,</span> <span class="s1">'u_speed'</span><span class="p">]:</span>
    <span class="n">F</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">set_region_figure</span><span class="p">(</span><span class="n">lon_range</span><span class="p">,</span> <span class="n">lat_range</span><span class="p">)</span>

    <span class="c1">#format_axes(ax)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Example Region | '</span><span class="o">+</span> <span class="n">var</span> <span class="o">+</span><span class="s1">' | '</span><span class="o">+</span> <span class="n">day_string</span><span class="p">)</span>
    <span class="n">dataplot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">ERA5_select</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">ERA5_select</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">ERA5_one_day</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">dataplot</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">'vertical'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">cbar_label</span><span class="p">(</span><span class="n">ERA5_select</span><span class="p">[</span><span class="n">var</span><span class="p">])</span> <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise">
<h3><em>Exercise:</em><a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Change the day you plot and try to observe how the temperature and the other two variables change betwee the days. We will look at the more carefully below</p></li>
</ul>
</div>
<div class="section" id="synoptic-variabilty">
<h3>2. Synoptic Variabilty<a class="headerlink" href="#synoptic-variabilty" title="Permalink to this headline">¶</a></h3>
<p>Lets explore how the temperature, ccloud cover and surface wind speed change in this region due to changes in weather. In most regions of the world the weather changes about every 5 days. Such that it will be helpful to look at the daily data every 5th day.</p>
</div>
<div class="section" id="id17">
<h3>Exercise:<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>To select dailyt means every 5 days, use the data in the selected region ‘ERA5_select’ an the function xr.resample. Then take the daily mean and then select the 0, 5, 10, and 15th day.
In a last step create the monthly mean of the data and subtract it from the select 5 days such that we can plot the anomalies from the monthly mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># annswer</span>
<span class="n">ERA5_synoptic</span><span class="o">=</span> <span class="n">ERA5_select</span><span class="o">.</span><span class="n">resample</span><span class="p">({</span><span class="s1">'time'</span><span class="p">:</span> <span class="s1">'1D'</span><span class="p">})</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">'time'</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
<span class="n">ERA5_select_mm</span> <span class="o">=</span> <span class="n">ERA5_select</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">'time'</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">ERA5_synoptic</span> <span class="o">=</span> <span class="p">(</span><span class="n">ERA5_synoptic</span> <span class="o">-</span> <span class="n">ERA5_select</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">'time'</span><span class="p">))</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Lets then plot the monthly mean and the 4 days foreach variable. Use the framework from the last section for the monthly mean and the function <em>plot_variable_Facet</em> like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot_variable_Facet(dataset, # the calculated data with only 4 selected timesteps</span>
<span class="c1">#                     var_name, #the name of the variable you want to plot (string)</span>
<span class="c1">#                     time_dim, "time", #the dimension along the facets of plots will be made, use "time" here</span>
<span class="c1">#                     title # optional string to give the plot a title</span>
<span class="c1">#                    )</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer, most compact version</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'t2m'</span><span class="p">,</span> <span class="s1">'u_speed'</span><span class="p">,</span> <span class="s1">'tcc'</span><span class="p">]:</span>

    <span class="n">F</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">set_region_figure</span><span class="p">(</span><span class="n">lon_range</span><span class="p">,</span> <span class="n">lat_range</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Monthly mean of '</span><span class="o">+</span> <span class="n">var</span> <span class="p">)</span>
    <span class="n">dataplot</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">ERA5_select_mm</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">ERA5_select_mm</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">ERA5_select_mm</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">dataplot</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">'vertical'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">cbar_label</span><span class="p">(</span><span class="n">ERA5_select</span><span class="p">[</span><span class="n">var</span><span class="p">])</span> <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">title_str</span> <span class="o">=</span>  <span class="n">ERA5_select</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">'long_name'</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" | daily anomalie from the monthly mean "</span>
    <span class="n">aa</span> <span class="o">=</span> <span class="n">plot_variable_Facet</span><span class="p">(</span><span class="n">ERA5_synoptic</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">time_dim</span> <span class="o">=</span><span class="s2">"time"</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span><span class="n">title_str</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>you should see 4 panels for each variable. Each panel shows the difference, the anomalie, to the monthly mean, and each panel is 5 days appart. You see that indeed the</p>
</div>
<div class="section" id="durinal-cycle-coastel-clouds-at-the-coast-on-a-sunny-day">
<h3>3. Durinal cycle - Coastel clouds at the coast on a sunny day?<a class="headerlink" href="#durinal-cycle-coastel-clouds-at-the-coast-on-a-sunny-day" title="Permalink to this headline">¶</a></h3>
<p>There is more the synoptic variability (~5 days) in the data. Lets think about how our data varying within 24 hours, but for that we have to look at the hourly data, rather then the daily mean.
During the day, the sun warms the surface and effect many other variables, like winds and cloud cover, eventhough that really depends on the region and the month you choose. To see the durinal cycle in the data we want to select timestamps in the morning (6 am), at noon (12pm), in the evening (6pm), at midnight (12 am).</p>
<p>However, the ERA5 data is saved with the UTC (Coordinated Universal Time), such that we have to shift the time axis to the local time. Here we take a shortcut use the longitudinal coordinate as proxi for the local time:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this functionn takes a longitudinal coodinate and returns the timezone difference compared to UTC.</span>
<span class="c1"># lets use here the center between the longitude boundaries of the domain and express it in the -180 to 180 coordinates again</span>
<span class="n">time_shift</span> <span class="o">=</span> <span class="n">get_time_compared_to_UTC</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lon_range</span><span class="p">)</span> <span class="o">-</span> <span class="mi">360</span><span class="p">)</span>
<span class="c1"># define a new coodinate "local_time" and add it to the coordinates of the dataset</span>
<span class="n">ERA5_select</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">'local_time'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ERA5_select</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">'time'</span><span class="p">]</span> <span class="o">+</span> <span class="n">time_shift</span>

<span class="c1">#this provides us with two time coorinates, one in UTC "time" and one in local time "local time"</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"UTC time   "</span><span class="p">,</span> <span class="n">ERA5_select</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">'time'</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"local time "</span><span class="p">,</span> <span class="n">ERA5_select</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">'local_time'</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we want to calculate the typical durinal cycle for the year and the month we chose before. For that, we can group the data by hour of the day, andthen take the mean for each hour of the day over the whole month, and then select hour 0 (midnight), 6, 12, and 24:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ERA5_durinal_cycle</span><span class="o">=</span> <span class="n">ERA5_select</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'local_time.hour'</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">'time'</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span><span class="mi">18</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>It is often better to show the data as the anomalie from a mean value, to see the differences in the data better. For that, we here just take the mean over the whole month and subtract it. The remaining data is the anomalous data, i.e. the anomalie of the durinal cyle from the monthly mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ERA5_durinal_cycle_anomalie</span> <span class="o">=</span> <span class="n">ERA5_durinal_cycle</span> <span class="o">-</span> <span class="n">ERA5_select</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">'time'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here we take the anomalie value because the spatial temperature difference can be quiet large.</span>
<span class="n">var</span><span class="o">=</span> <span class="s1">'t2m'</span>
<span class="n">plot_variable_Facet</span><span class="p">(</span><span class="n">ERA5_durinal_cycle_anomalie</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">time_dim</span> <span class="o">=</span><span class="s2">"hour"</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">"2-meter temperature Anomalie from monthly mean at hour:"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">var</span><span class="o">=</span> <span class="s1">'u_speed'</span>
<span class="n">plot_variable_Facet</span><span class="p">(</span><span class="n">ERA5_durinal_cycle_anomalie</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">time_dim</span> <span class="o">=</span><span class="s2">"hour"</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">"typical Wind Speed Anomalie at hour:"</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">var</span><span class="o">=</span> <span class="s1">'tcc'</span>
<span class="n">plot_variable_Facet</span><span class="p">(</span><span class="n">ERA5_durinal_cycle_anomalie</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">time_dim</span> <span class="o">=</span><span class="s2">"hour"</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">"Total Cloud Cover Anomalie at hour"</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Purples</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="discussion-questions">
<h3><em>Discussion Questions:</em><a class="headerlink" href="#discussion-questions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Where in your choosen region do you see the largest typical temperature changes over the course of the day? Where do see the smallest changes? Is that what you expected?</p></li>
<li><p>Look at the wind speed and the surface temperature. Where do you see the strongest wind anomalies over the course of a day, why?</p></li>
<li><p>Where do you see the most cloud cover? how is that related to the winds and the temperature?</p></li>
</ul>
<div class="section" id="short-answers">
<h4>short answers:<a class="headerlink" href="#short-answers" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Where in your choosen region do you see the largest typical temperature changes over the course of the day? Where do see the smallest changes? Is that what you expected?
the largest changes are over land, because the land repsonses quickly to solar radiation. the changes over the ocean are small, because the ocean need much longer to heat up by the sun.</p></li>
<li><p>Look at the wind speed and the surface temperature. Where do you see the strongest wind anomalies over the course of a day, why?
The winds are stronger over land when the solar radiation is highest and the surface the warmest. The changes in the durinal cycle of winds over the ocean however is small (that doesn’t mean the winds are generally weak).</p></li>
<li><p>Where do you see the most cloud cover? how is that related to the winds and the temperature?
the largest cloud cover is along the coast line because of the sea-breeze phenomonen. it advects cold air from the ocean over to the land and leads to clouds.</p></li>
</ul>
<p>have a look here:
https://www.youtube.com/watch?v=X2Wfp2rPvMY
and read here:
https://resources.eumetrain.org/satmanu/CMs/SB/print.htm</p>
</div>
</div>
</div>
<div class="section" id="part-4-another-way-to-look-at-variabilty-creating-time-series">
<h2>Part 4: Another way to look at variabilty: Creating time series<a class="headerlink" href="#part-4-another-way-to-look-at-variabilty-creating-time-series" title="Permalink to this headline">¶</a></h2>
<p>By not you might have realized that there are a lot of change in the data on many time scale, ranging from changes wihtin a day to, changes from day to day and from month to month. This <em>variability</em> in the data important to understand when we do climate analysis.</p>
<p>Rather then plotting spatial maps for different time steps or time scale, in this last part of the tutorial we will create timeseries from the same data you look at already. That is staight foreward. Instead of taking the mean in time, we take the mean in space.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ERA5_ts</span> <span class="o">=</span> <span class="n">ERA5_select</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">'longitude'</span><span class="p">,</span> <span class="s1">'latitude'</span><span class="p">])</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax_list</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">6.6</span><span class="p">),</span>  <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span>  <span class="nb">zip</span><span class="p">([</span><span class="s1">'t2m'</span><span class="p">,</span> <span class="s1">'tcc'</span><span class="p">,</span> <span class="s1">'u_speed'</span><span class="p">],</span> <span class="n">ax_list</span> <span class="p">):</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ERA5_ts</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ERA5_ts</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">cbar_label</span><span class="p">(</span><span class="n">ERA5_select</span><span class="p">[</span><span class="n">var</span><span class="p">]),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">'left'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="questions">
<h3><em>Questions</em><a class="headerlink" href="#questions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Which variable is dominated by the durinal cycle?</p></li>
<li><p>which variable by the synoptic scale (~ 5 day)?</p></li>
</ul>
</div>
</div>
<div class="section" id="id18">
<h2><em>Exercise</em>:<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h2>
<p>In this final exercise, let’s compare the effect of spatial averaging and temporal avering on the data.
For that, focus on the surface wind speed ‘u_speed’ and make four different time series that represent the wind speed in the region</p>
<ul class="simple">
<li><ol class="simple">
<li><p>ERA5_ts_spatial_average  - <em>this is the timeseries of the spatial average of data for each timestep (as above)</em></p></li>
</ol>
</li>
<li><ol class="simple">
<li><p>ERA5_ts_point - <em>this is the hourly timeseries on data at one grid point in the center of your domain</em></p></li>
</ol>
</li>
<li><ol class="simple">
<li><p>ERA5_ts_point_daily  - <em>this is the timeseries of the point data but resamples the daily values</em></p></li>
</ol>
</li>
<li><ol class="simple">
<li><p>ERA5_ts_spatial_average_daily  - <em>this is the timeseries of the spatially averaged data but also resamples the daily values</em></p></li>
</ol>
</li>
</ul>
<p>plot the data!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># answers:</span>
<span class="n">var</span> <span class="o">=</span> <span class="s1">'u_speed'</span>
<span class="n">ERA5_ts_spatial_average</span> <span class="o">=</span> <span class="n">ERA5_select</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">'longitude'</span><span class="p">,</span> <span class="s1">'latitude'</span><span class="p">])</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">ERA5_ts_point</span>           <span class="o">=</span> <span class="n">ERA5_select</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span> <span class="n">longitude</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lon_range</span><span class="p">)</span> <span class="p">,</span> <span class="n">latitude</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lat_range</span><span class="p">),</span> <span class="n">method</span> <span class="o">=</span><span class="s1">'nearest'</span> <span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="n">ERA5_ts_point_daily</span>     <span class="o">=</span> <span class="n">ERA5_ts_point</span><span class="o">.</span><span class="n">resample</span><span class="p">({</span><span class="s1">'time'</span> <span class="p">:</span><span class="s1">'1D'</span><span class="p">},</span> <span class="n">offset</span><span class="o">=</span> <span class="s1">'12h'</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">ERA5_ts_spatial_average_daily</span> <span class="o">=</span> <span class="n">ERA5_ts_spatial_average</span><span class="o">.</span><span class="n">resample</span><span class="p">({</span><span class="s1">'time'</span> <span class="p">:</span><span class="s1">'1D'</span><span class="p">},</span> <span class="n">offset</span><span class="o">=</span> <span class="s1">'12h'</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#answer part II:</span>
<span class="n">ERA5_ts_point</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span> <span class="s1">'gray'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'point data'</span><span class="p">)</span>
<span class="n">ERA5_ts_point_daily</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span> <span class="s1">'black'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'*'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'daily average point data'</span><span class="p">)</span>

<span class="n">ERA5_ts_spatial_average</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span> <span class="s1">'darkblue'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'spatial average'</span><span class="p">)</span>
<span class="n">ERA5_ts_spatial_average_daily</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span> <span class="s1">'blue'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'*'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">'daily and spatial average'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id19">
<h2><em>Questions</em>:<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>What is the difference in these 4 four time series?</p></li>
<li><p>What version represents the wind speed in the region the best way?</p></li>
</ul>
<p>#comments:</p>
<p>All four timeseries are different represenations on the wind variability in the region.
The spatial averaging acts as a smothing of the data and hene has less varaiblity the the point data. However, we often don’t have all the data all the time and instead just some <em>sample</em> of the wind speed, as for example in the point data.
But that point data shows a different variability than then spatial average, regardless if we resample to 1 day or not. Be aware that the resolution of the data and the way it is averaged and sampled matters!</p>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial you learned how to access and navigaate ERA5 renanlysis data. You can now select subregions in the renalysis and take averages or subsamples in space and time.
You have seen how averaging data reduces the variabilty and that any dataset, ranging from timeseries to spatial maps has a resolution and a timestep that are important to know when understanding the data.</p>
</div>
<hr class="docutils"/>
<div class="section" id="bonus-extending-the-timeseries-analysis-to-long-timeperiods">
<h1>Bonus: Extending the timeseries analysis to long timeperiods<a class="headerlink" href="#bonus-extending-the-timeseries-analysis-to-long-timeperiods" title="Permalink to this headline">¶</a></h1>
<p>Use the tools provided above and make a timeseries of the surface temperature und and surface wind over the 30 years of the ERA5 data. First select the region in ERA5 as before but know use all time steps. Then resample to daily means and plot each variable in a single planel or figure.</p>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "pangeo"
        },
        kernelOptions: {
            kernelName: "pangeo",
            path: "./tutorials/W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'pangeo'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="W1D2_Tutorial1.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Calculating ENSO with Xarray</p>
</div>
</a>
<a class="right-next" href="W1D2_Tutorial3.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Tutorial 3: Atmospheric wind driven circulation</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Climatematch<br/>
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>