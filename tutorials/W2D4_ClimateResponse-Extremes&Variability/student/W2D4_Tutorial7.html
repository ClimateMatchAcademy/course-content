
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Load CMIP6 data â€” Climatematch Academy: Computational Tools for Climate Science</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/custom.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<link href="../../../_static/cma-logo-square-4xp.png" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W2D4_Tutorial8.html" rel="next" title="scale as function of time"/>
<link href="W2D4_Tutorial6.html" rel="prev" title="&lt;no title&gt;"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
<img alt="logo" class="logo" src="../../../_static/cma-logo-square-4xp.png"/>
<h1 class="site-logo" id="site-title">Climatematch Academy: Computational Tools for Climate Science</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../Schedule/schedule_intro.html">
   Schedule
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../Schedule/daily_schedules.html">
     General Schedule
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_jupyterhub.html">
<strong>
        Using JupyterHub
       </strong>
</a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using discord
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Fundamentals
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/chapter_title.html">
   Climate System Overview (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial1.html">
<strong>
      Tutorial 1: Creating DataArrays and Datasets to Assess Global Climate Data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial2.html">
<strong>
      Tutorial 2: Selection, Interpolation and Slicing
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial3.html">
<strong>
      Tutorial 3: Opening and Plotting netCDF Data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial4.html">
<strong>
      Tutorial 4: Arithmetic and Aggregation Methods
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial5.html">
<strong>
      Tutorial 5: Xarray Data Analysis and Climatology
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial6.html">
<strong>
      Tutorial 6: Compute and Plot Temperature Anomalies
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial7.html">
<strong>
      Tutorial 7: Other Computational Tools in Xarray
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial8.html">
<strong>
      Tutorial 8: Masking with One Condition
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ClimateSystemOverview/student/W1D1_Tutorial9.html">
<strong>
      Tutorial 9: Masking with Multiple Conditions
     </strong>
</a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/chapter_title.html">
   Good Research Practices (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial1.html">
<strong>
      Tutorial 1: Finding a Phenomenon and Asking a Question About It
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial2.html">
<strong>
      Tutorial 2: Doing a Literature Review
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial3.html">
<strong>
      Tutorial 3: Identifying the Basic Ingredients
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial4.html">
<strong>
      Tutorial 4: Formulating a Hypothesis
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial5.html">
<strong>
      Tutorial 5: Drafting the Analysis
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial6.html">
<strong>
      Tutorial 6: Implementing the Analysis
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial7.html">
<strong>
      Tutorial 7: Interpreting the Results
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial8.html">
<strong>
      Tutorial 8: Communicating Your Conclusions
     </strong>
</a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Climate Data
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/chapter_title.html">
   State of the Climate Ocean and Atmosphere Reanalysis (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial1.html">
<strong>
      Tutorial 1: Calculating ENSO with Xarray
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial2.html">
<strong>
      Tutorial 2: A Lot of Weather Makes Climate - Exploring the ERA5 Reanalysis
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial3.html">
<strong>
      Tutorial 3: Atmospheric  Circulation
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial4.html">
<strong>
      Tutorial 4: Oceanic Wind-driven Circulation
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial5.html">
<strong>
      Tutorial 5: Thermohaline Circulation
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial6.html">
<strong>
      Tutorial 6: Ocean Heat Content
     </strong>
</a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/chapter_title.html">
   Remote Sensing Land Ocean and Atmosphere (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial1.html">
<strong>
      Tutorial 1: Introduction to Remote Sensing
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial2.html">
<strong>
      Tutorial 2: Exploring Satellite Climate Data Records
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial3.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial4.html">
<strong>
      Tutorial 4: Understanding Climatology Through Precipitation Data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial5.html">
<strong>
      Tutorial 5: Calculating Anomalies Using Precipitation Data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial6.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial7.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial8.html">
     Figure settings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_Paleoclimate/chapter_title.html">
   Paleoclimate (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial1.html">
<strong>
      Tutorial 1: Paleoclimate Proxies
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial2.html">
<strong>
      Tutorial 2: Reconstructing Past Changes in Ocean Climate
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial3.html">
<strong>
      Tutorial 3: Reconstructing Past Changes in Terrestrial Climate
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial4.html">
<strong>
      Tutorial 4: Reconstructing Past Changes in Atmospheric Climate
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial5.html">
<strong>
      Tutorial 5: Paleoclimate Data Analysis Tools
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial6.html">
<strong>
      Tutorial 6: Spectral Analysis of Paleoclimate Data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial7.html">
<strong>
      Tutorial 7: Assessing Climate Forcings
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial8.html">
<strong>
      Tutorial 8: Paleoclimate Models
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial9.html">
<strong>
      Tutorial 9: Paleoclimate Reanalysis Products
     </strong>
</a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Climate Future
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_ClimateModeling/chapter_title.html">
   Climate Modeling (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial1.html">
<strong>
      Tutorial 1 : A Simple Greenhouse Model
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial2.html">
<strong>
      Tutorial 2 : Energy Balance
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial3.html">
<strong>
      Tutorial 3 : A Zero-Dimensional Energy Balance Model
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial4.html">
<strong>
      Tutorial 4: Climate Feedbacks
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial5.html">
<strong>
      Tutorial 5: Radiative Equilibrium
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial6.html">
<strong>
      Tutorial 6: Radiative Convective Equilibrium
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial7.html">
<strong>
      Tutorial 7: Introduction to Earth System Models
     </strong>
</a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/chapter_title.html">
   Future Climate - IPCC I Physical Basis (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial1.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial2.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial3.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial4.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial5.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial6.html">
     Figure settings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/chapter_title.html">
   Future Climate - IPCC II &amp; III Socio-Economic Basis (W2D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/student/W2D3_Tutorial1.html">
<strong>
      Tutorial Objectives
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/student/W2D3_Tutorial2.html">
<strong>
      Tutorial 2: Transition Goals and Integrated Assessment Models
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/student/W2D3_Tutorial4.html">
<strong>
      Tutorial 4: Public Opinion on the Climate Emergency and Why it Matters
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/further_reading.html">
<strong>
      Tutorial 2 Further Reading
     </strong>
</a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Climate Response
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Climate Response - Extremes &amp; Variability (W2D4)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Tutorial2.html">
     Data investigation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Tutorial5.html">
     Fit Moments using a different method
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Load CMIP6 data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D4_Tutorial8.html">
     scale as function of time
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/chapter_title.html">
   Climate Response - Adaptation Impact (W2D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial1.html">
<strong>
      Tutorial 1: Linear and Logistic Regression
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial2.html">
<strong>
      Tutorial 2:  Regression and Decision Trees on the Dengue Fever Dataset
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial3.html">
<strong>
      Tutorial 3:  Logistic Regression and ANN on the Remote Sensing Crop Dataset
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial4.html">
<strong>
      Tutorial 4:  Exploring other applications
     </strong>
</a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/datasets_overview.html">
   Project materials
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Sea_level_rise.html">
<strong>
      Sea level rise
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Ocean_acidification.html">
<strong>
      Ocean acidification
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/ENSO_impact_on_precipitation_and_temperature.html">
<strong>
      The impact of ENSO on precipitation and temperature
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Regional_precipitation_variability.html">
<strong>
      Regional precipitation variability and extreme events
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Heatwaves.html">
<strong>
      Heatwaves: Assessing the dynamic interactions of the atmosphere and land
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Wildfires_and_burnt_areas.html">
<strong>
      Monitoring and mapping wildfires using satellite data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Surface_albedo_and_land_use.html">
<strong>
      Change in Earthâ€™s albedo and its dependence on land cover changes in the past 20 years
     </strong>
</a>
</li>
</ul>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/continuing_your_project_after_the_course.html">
   Continuing your project after the course
  </a>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://climatematch.2i2c.cloud/hub/user-redirect/git-pull?repo=https%3A//github.com/ClimatematchAcademy/course-content&amp;urlpath=lab/tree/course-content/book/tutorials/W2D4_ClimateResponse-Extremes%26Variability/student/W2D4_Tutorial7.ipynb&amp;branch=main" title="Launch on JupyterHub">
<span class="headerbtn__icon-container">
<img src="../../../_static/images/logo_jupyterhub.svg"/>
</span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>
</li>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/ClimatematchAcademy/course-content" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/ClimatematchAcademy/course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W2D4_ClimateResponse-Extremes&amp;Variability/student/W2D4_Tutorial7.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W2D4_ClimateResponse-Extremes&amp;Variability/student/W2D4_Tutorial7.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Load CMIP6 data
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#shortcut">
   Shortcut
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#through-pangeo">
   Through pangeo
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#processing">
   Processing
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#scenarios">
   Scenarios
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#potential-add-on-spatial-analysis">
   Potential add-on: spatial analysis
  </a>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Load CMIP6 data</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Load CMIP6 data
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#shortcut">
   Shortcut
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#through-pangeo">
   Through pangeo
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#processing">
   Processing
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#scenarios">
   Scenarios
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#potential-add-on-spatial-analysis">
   Potential add-on: spatial analysis
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<p>For this 7th tutorial we will study climate model output for different cities in the world, and look at how extreme temperature and precipitation changes over time and depending on emission scenarios</p>
<div class="cell tag_colab docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># #install dependencies - taken from &lt;Yosmely BermÃºdez&gt; comments for Tutorial 6</span>
<span class="c1"># # We need this to install eigen which is needed for SDFC to install correctly</span>
<span class="c1"># !pip install -q condacolab</span>
<span class="c1"># import condacolab</span>
<span class="c1"># condacolab.install()</span>
<span class="c1"># !conda install eigen</span>
<span class="c1"># !pip install -v https://github.com/yrobink/SDFC/archive/master.zip#subdirectory=python</span>
<span class="c1"># !pip install https://github.com/njleach/mystatsfunctions/archive/master.zip</span>
<span class="c1"># !pip install numpy</span>
<span class="c1"># !pip install matplotlib</span>
<span class="c1"># !pip install seaborn</span>
<span class="c1"># !pip install pandas</span>
<span class="c1"># !pip install cartopy</span>
<span class="c1"># !pip install scipy</span>
<span class="c1"># !pip install texttable</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">extremes_functions</span> <span class="k">as</span> <span class="nn">ef</span>
<span class="kn">from</span> <span class="nn">mystatsfunctions</span> <span class="kn">import</span> <span class="n">OLSE</span><span class="p">,</span><span class="n">LMoments</span>
<span class="kn">import</span> <span class="nn">SDFC</span> <span class="k">as</span> <span class="nn">sd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gev</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">genextreme</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">estimate_return_level</span><span class="p">(</span><span class="n">quantile</span><span class="p">,</span><span class="n">model</span><span class="p">):</span>
    <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span>
    <span class="n">level</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">-</span> <span class="n">scale</span> <span class="o">/</span> <span class="n">shape</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">quantile</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">shape</span><span class="p">))</span>
    <span class="c1"># level = stats.genextreme.ppf(quantile,-shape,loc=loc,scale=scale)</span>
    <span class="k">return</span> <span class="n">level</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="load-cmip6-data">
<h1>Load CMIP6 data<a class="headerlink" href="#load-cmip6-data" title="Permalink to this headline">Â¶</a></h1>
</div>
<div class="section" id="shortcut">
<h1>Shortcut<a class="headerlink" href="#shortcut" title="Permalink to this headline">Â¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">pooch</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s1">'cmip6_data_city_daily_scenarios_tasmax_pr_models.nc'</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">"https://osf.io/ngafk/download"</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">known_hash</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># data = xr.open_dataset('cmip6_data_city_daily_scenarios.nc')</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="through-pangeo">
<h1>Through pangeo<a class="headerlink" href="#through-pangeo" title="Permalink to this headline">Â¶</a></h1>
<p>The code below recreates the data loaded in the previous line.</p>
<p>In this way you can access large amounts of climate model output that has been stored in the cloud. This is very useful to get easy access to such information. Feel free to modify the code to access different data and address your own questions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">intake</span>

<span class="kn">from</span> <span class="nn">xmip.preprocessing</span> <span class="kn">import</span> <span class="n">combined_preprocessing</span>
<span class="kn">from</span> <span class="nn">xarrayutils.plotting</span> <span class="kn">import</span> <span class="n">shaded_line_plot</span>

<span class="kn">from</span> <span class="nn">xmip.utils</span> <span class="kn">import</span> <span class="n">google_cmip_col</span>
<span class="c1"># we could do all of this with pure pandas on the underlying csv file</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">google_cmip_col</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
    <span class="c1"># source_id=['IPSL-CM6A-LR', 'GFDL-ESM4', 'ACCESS-CM2', 'MPI-ESM1-2-LR', 'TaiESM1'],</span>
    <span class="c1"># source_id=['CESM2','MPI-ESM1-2-HR'],</span>
    <span class="n">source_id</span><span class="o">=</span><span class="s1">'MPI-ESM1-2-HR'</span><span class="p">,</span>
    <span class="n">variable_id</span><span class="o">=</span><span class="p">[</span><span class="s1">'pr'</span><span class="p">,</span><span class="s1">'tas'</span><span class="p">],</span>
    <span class="n">member_id</span><span class="o">=</span><span class="s1">'r1i1p1f1'</span><span class="p">,</span> <span class="c1">#</span>
    <span class="n">table_id</span><span class="o">=</span><span class="s1">'day'</span><span class="p">,</span>
    <span class="n">grid_label</span><span class="o">=</span><span class="s1">'gn'</span><span class="p">,</span>
    <span class="n">experiment_id</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'historical'</span><span class="p">,</span><span class="s1">'ssp126'</span><span class="p">,</span> <span class="s1">'ssp245'</span><span class="p">,</span> <span class="s1">'ssp585'</span><span class="p">],</span>
    <span class="c1"># experiment_id = ['historical', 'ssp126', 'ssp585'],</span>
    <span class="c1"># require_all_on = ['source_id']</span>
<span class="p">)</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">preprocess</span><span class="o">=</span><span class="n">combined_preprocessing</span><span class="p">,</span> <span class="n">xarray_open_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">use_cftime</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">ds_dict</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">to_dataset_dict</span><span class="p">(</span><span class="n">zarr_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">'consolidated'</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>Define one or more locations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sel_Hamburg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="mf">53.5</span><span class="p">)</span>
<span class="n">sel_Madrid</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="mi">360</span><span class="o">-</span><span class="mi">42</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="mf">40.5</span><span class="p">)</span>
<span class="n">sel_Delhi</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="mi">77</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="mf">28.5</span><span class="p">)</span>
<span class="n">sel_Kinshasa</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">lat</span><span class="o">=-</span><span class="mi">4</span><span class="p">)</span>
<span class="n">sel_Phoenix</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="mi">360</span><span class="o">-</span><span class="mi">112</span><span class="p">,</span><span class="n">lat</span><span class="o">=</span><span class="mf">33.5</span><span class="p">)</span>
<span class="n">sel_Sydney</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="mi">151</span><span class="p">,</span><span class="n">lat</span><span class="o">=-</span><span class="mf">33.85</span><span class="p">)</span>

<span class="n">sels</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">Hamburg</span> <span class="o">=</span> <span class="n">sel_Hamburg</span><span class="p">,</span>
    <span class="n">Madrid</span> <span class="o">=</span> <span class="n">sel_Madrid</span><span class="p">,</span>
    <span class="n">Delhi</span> <span class="o">=</span> <span class="n">sel_Delhi</span><span class="p">,</span>
    <span class="n">Kinshasa</span> <span class="o">=</span> <span class="n">sel_Kinshasa</span><span class="p">,</span>
    <span class="n">Phoenix</span> <span class="o">=</span> <span class="n">sel_Phoenix</span><span class="p">,</span>
    <span class="n">Sydney</span> <span class="o">=</span> <span class="n">sel_Sydney</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Assemble your data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="s1">'MPI-ESM1-2-HR'</span>
<span class="n">scenarios</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ssp126'</span><span class="p">,</span><span class="s1">'ssp245'</span><span class="p">,</span><span class="s1">'ssp585'</span><span class="p">]</span>
<span class="n">outs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">city</span> <span class="ow">in</span> <span class="n">sels</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">outis</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="n">scenarios</span><span class="p">:</span>
        <span class="n">timeseries</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">ds_dict</span><span class="p">[</span><span class="s1">'CMIP.MPI-M.</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">.day.gn'</span> <span class="o">%</span> <span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">'historical'</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sels</span><span class="p">[</span><span class="n">city</span><span class="p">],</span><span class="n">method</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">'2014'</span><span class="p">)),</span>
                        <span class="n">ds_dict</span><span class="p">[</span><span class="s1">'ScenarioMIP.DKRZ.</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">.day.gn'</span> <span class="o">%</span> <span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">scenario</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">sels</span><span class="p">[</span><span class="n">city</span><span class="p">],</span><span class="n">method</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">)</span>
                    <span class="p">],</span><span class="s1">'time'</span>
                    <span class="p">)</span>
        <span class="n">timeseries</span> <span class="o">=</span> <span class="n">timeseries</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">city</span><span class="o">=</span><span class="n">city</span><span class="p">,</span><span class="n">scenario</span><span class="o">=</span><span class="n">scenario</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="n">outis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span>
        <span class="c1"># outis.append(ds_dict[key].sel(sels[city],method='nearest').assign_coords(city=city,scenario=key).squeeze())</span>
    <span class="n">outs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">outis</span><span class="p">,</span><span class="s1">'scenario'</span><span class="p">))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">outs</span><span class="p">,</span><span class="s1">'city'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'The data has </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">nbytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> MB'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data.load()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="processing">
<h1>Processing<a class="headerlink" href="#processing" title="Permalink to this headline">Â¶</a></h1>
<p>Look at the data for one selected city, for one climate model</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">city</span> <span class="o">=</span> <span class="s1">'Madrid'</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data_city = data.sel(city=city,model='MPI-ESM1-2-HR')</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data_city</span>
</pre></div>
</div>
</div>
</div>
<p>The data is has daily resolution, for three climate scenarios - those start in 2014, so until 2014 they are the same and then diverge</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fig, ax = plt.subplots(2,sharex=True,figsize=(10,3),constrained_layout=True)</span>
<span class="c1"># data_city['tasmax'].plot(hue='scenario',ax=ax[0])</span>
<span class="c1"># data_city['pr'].plot(hue='scenario',ax=ax[1])</span>

<span class="c1"># ax[0].set_title('Daily maximum surface air temperature')</span>
<span class="c1"># ax[1].set_title('Precipitation')</span>
</pre></div>
</div>
</div>
</div>
<p>Do the same with a 30-year rolling mean</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fig, ax = plt.subplots(2,sharex=True,figsize=(10,3),constrained_layout=True)</span>
<span class="c1"># data_city['tasmax'].rolling(time=30*365).mean().plot(hue='scenario',ax=ax[0])</span>
<span class="c1"># data_city['pr'].rolling(time=30*365).mean().plot(hue='scenario',ax=ax[1],add_legend=False)</span>

<span class="c1"># ax[0].set_title('Daily maximum surface air temperature')</span>
<span class="c1"># ax[1].set_title('Precipitation')</span>
</pre></div>
</div>
</div>
</div>
<p>In the previous tutorials we have been operating on annual maxima data. That is want to take the day in each year with the highest temperature or the largest amount of rainfall</p>
<p>Letâ€™s focus on precipitation for now, and compute the maximum for each year</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
     <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
     <span class="n">coords</span><span class="o">=</span><span class="p">[</span>
         <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
             <span class="s2">"1999-12-15"</span><span class="p">,</span>
             <span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
             <span class="n">freq</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">months</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
         <span class="p">)</span>
     <span class="p">],</span>
     <span class="n">dims</span><span class="o">=</span><span class="s2">"time"</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s2">"QS-DEC"</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pr_city = data_city['pr']</span>
<span class="c1"># pr_city_max= pr_city.resample(time='1Y').max()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pr_city.groupby('time.year').max()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fig, ax = plt.subplots()</span>
<span class="c1"># pr_city_max.plot(hue='scenario',ax=ax)</span>

<span class="c1"># ax.set_title('Annual maximum precipitation')</span>
</pre></div>
</div>
</div>
</div>
<p>Repeat the previous analysis: take the historical run (1850-2014), look at three 30-year periods, and compute Extreme Values. Change the periods because the historical run ends in 2014. Therefore just select one of the scenarios.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data_period1 = pr_city_max.sel(scenario='ssp245',time=slice('2014')).sel(time=slice('1925','1954')).to_pandas()</span>
<span class="c1"># data_period2 = pr_city_max.sel(scenario='ssp245',time=slice('2014')).sel(time=slice('1955','1984')).to_pandas()</span>
<span class="c1"># data_period3 = pr_city_max.sel(scenario='ssp245',time=slice('2014')).sel(time=slice('1985','2015')).to_pandas()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.histplot(data_period1,bins=np.arange(20,90,5),color='C0',element='step',alpha=0.5,kde=True,label='1931-1960')</span>
<span class="c1"># sns.histplot(data_period2,bins=np.arange(20,90,5),color='C1',element='step',alpha=0.5,kde=True,label='1961-1990')</span>
<span class="c1"># sns.histplot(data_period3,bins=np.arange(20,90,5),color='C2',element='step',alpha=0.5,kde=True,label='1991-2020')</span>
<span class="c1"># plt.legend()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># periods_stats = pd.DataFrame(index=['Mean','Standard Deviation','Skew'])</span>
<span class="c1"># periods_stats['1931-1960'] = [data_period1.mean(), data_period1.std(), data_period1.skew()]</span>
<span class="c1"># periods_stats['1961-1990'] = [data_period2.mean(), data_period2.std(), data_period2.skew()]</span>
<span class="c1"># periods_stats['1991-2020'] = [data_period3.mean(), data_period3.std(), data_period3.skew()]</span>

<span class="c1"># periods_stats = periods_stats.T</span>
<span class="c1"># periods_stats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit_period1, model_period1 = ef.fit_return_levels_sdfc(data_period1.values,times=np.arange(1.1,1000),periods_per_year=1,kind='GEV',N_boot=1000,full=True,model=True)</span>
<span class="c1"># fit_period2, model_period2 = ef.fit_return_levels_sdfc(data_period2.values,times=np.arange(1.1,1000),periods_per_year=1,kind='GEV',N_boot=1000,full=True,model=True)</span>
<span class="c1"># fit_period3, model_period3 = ef.fit_return_levels_sdfc(data_period3.values,times=np.arange(1.1,1000),periods_per_year=1,kind='GEV',N_boot=1000,full=True,model=True)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fig, ax = plt.subplots()</span>
<span class="c1"># x = np.linspace(20,90,1000)</span>
<span class="c1"># ax.plot(x,gev.pdf(</span>
<span class="c1">#     x,</span>
<span class="c1">#     -model_period1.shape.mean(),</span>
<span class="c1">#     loc=model_period1.loc.mean(),</span>
<span class="c1">#     scale=model_period1.scale.mean()</span>
<span class="c1">#     ),</span>
<span class="c1">#     c='C0',lw=3,label='1931-1960')</span>
<span class="c1"># ax.plot(x,gev.pdf(</span>
<span class="c1">#     x,</span>
<span class="c1">#     -model_period2.shape.mean(),</span>
<span class="c1">#     loc=model_period2.loc.mean(),</span>
<span class="c1">#     scale=model_period2.scale.mean()</span>
<span class="c1">#     ),</span>
<span class="c1">#     c='C1',lw=3,label='1961-1990')</span>
<span class="c1"># ax.plot(x,gev.pdf(</span>
<span class="c1">#     x,</span>
<span class="c1">#     -model_period3.shape.mean(),</span>
<span class="c1">#     loc=model_period3.loc.mean(),</span>
<span class="c1">#     scale=model_period3.scale.mean()</span>
<span class="c1">#     ),</span>
<span class="c1">#     c='C2',lw=3,label='1991-2020')</span>
<span class="c1"># ax.legend()</span>
<span class="c1"># ax.set_xlabel('annual maximum precipitation (mm/day)')</span>
<span class="c1"># ax.set_ylabel('Density')</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters = pd.DataFrame(index=['Location', 'Scale', 'Shape'])</span>
<span class="c1"># parameters['1931-1960'] = [model_period1.loc.mean(), model_period1.scale.mean(), model_period1.shape.mean()]</span>
<span class="c1"># parameters['1961-1990'] = [model_period2.loc.mean(), model_period2.scale.mean(), model_period2.shape.mean()]</span>
<span class="c1"># parameters['1991-2020'] = [model_period3.loc.mean(), model_period3.scale.mean(), model_period3.shape.mean()]</span>

<span class="c1"># parameters = parameters.T</span>
<span class="c1"># parameters.round(4)#.astype('%.2f')</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="scenarios">
<h1>Scenarios<a class="headerlink" href="#scenarios" title="Permalink to this headline">Â¶</a></h1>
<p>Now letâ€™s look at hot days in possible climate futures: the years 2050-2080</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data_city = data.sel(city=city,model='MPI-ESM1-2-HR')</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># tasmax_city_fut = data_city['tasmax'].sel(time=slice('2050','2079')).resample(time='1Y').max()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.histplot(data=tasmax_city_fut.to_dataframe()['tasmax'].reset_index(),x='tasmax',hue='scenario',kde=True,bins=np.arange(294,302,0.5))#.plot.hist(hue='scenario')</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data_period1 = tasmax_city_fut.sel(scenario='ssp126').to_pandas()</span>
<span class="c1"># data_period2 = tasmax_city_fut.sel(scenario='ssp245').to_pandas()</span>
<span class="c1"># data_period3 = tasmax_city_fut.sel(scenario='ssp585').to_pandas()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sns.histplot(data_period1,bins=np.arange(294,302,0.5),color='C0',element='step',alpha=0.5,kde=True,label='1931-1960')</span>
<span class="c1"># sns.histplot(data_period2,bins=np.arange(294,302,0.5),color='C1',element='step',alpha=0.5,kde=True,label='1961-1990')</span>
<span class="c1"># sns.histplot(data_period3,bins=np.arange(294,302,0.5),color='C2',element='step',alpha=0.5,kde=True,label='1991-2020')</span>
<span class="c1"># plt.legend()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># periods_stats = pd.DataFrame(index=['Mean','Standard Deviation','Skew'])</span>
<span class="c1"># periods_stats['1931-1960'] = [data_period1.mean(), data_period1.std(), data_period1.skew()]</span>
<span class="c1"># periods_stats['1961-1990'] = [data_period2.mean(), data_period2.std(), data_period2.skew()]</span>
<span class="c1"># periods_stats['1991-2020'] = [data_period3.mean(), data_period3.std(), data_period3.skew()]</span>

<span class="c1"># periods_stats = periods_stats.T</span>
<span class="c1"># periods_stats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit_period1, model_period1 = ef.fit_return_levels_sdfc(data_period1.values,times=np.arange(1.1,1000),periods_per_year=1,kind='GEV',N_boot=1000,full=True,model=True)</span>
<span class="c1"># fit_period2, model_period2 = ef.fit_return_levels_sdfc(data_period2.values,times=np.arange(1.1,1000),periods_per_year=1,kind='GEV',N_boot=1000,full=True,model=True)</span>
<span class="c1"># fit_period3, model_period3 = ef.fit_return_levels_sdfc(data_period3.values,times=np.arange(1.1,1000),periods_per_year=1,kind='GEV',N_boot=1000,full=True,model=True)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fig, ax = plt.subplots()</span>
<span class="c1"># x = np.linspace(293,302,1000)</span>
<span class="c1"># ax.plot(x,gev.pdf(</span>
<span class="c1">#     x,</span>
<span class="c1">#     -model_period1.shape.mean(),</span>
<span class="c1">#     loc=model_period1.loc.mean(),</span>
<span class="c1">#     scale=model_period1.scale.mean()</span>
<span class="c1">#     ),</span>
<span class="c1">#     c='C0',lw=3,label='1931-1960')</span>
<span class="c1"># ax.plot(x,gev.pdf(</span>
<span class="c1">#     x,</span>
<span class="c1">#     -model_period2.shape.mean(),</span>
<span class="c1">#     loc=model_period2.loc.mean(),</span>
<span class="c1">#     scale=model_period2.scale.mean()</span>
<span class="c1">#     ),</span>
<span class="c1">#     c='C1',lw=3,label='1961-1990')</span>
<span class="c1"># ax.plot(x,gev.pdf(</span>
<span class="c1">#     x,</span>
<span class="c1">#     -model_period3.shape.mean(),</span>
<span class="c1">#     loc=model_period3.loc.mean(),</span>
<span class="c1">#     scale=model_period3.scale.mean()</span>
<span class="c1">#     ),</span>
<span class="c1">#     c='C2',lw=3,label='1991-2020')</span>
<span class="c1"># ax.legend()</span>
<span class="c1"># ax.set_xlabel('annual maximum daily maximum temperature (K)')</span>
<span class="c1"># ax.set_ylabel('Density')</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters = pd.DataFrame(index=['Location', 'Scale', 'Shape'])</span>
<span class="c1"># parameters['1931-1960'] = [model_period1.loc.mean(), model_period1.scale.mean(), model_period1.shape.mean()]</span>
<span class="c1"># parameters['1961-1990'] = [model_period2.loc.mean(), model_period2.scale.mean(), model_period2.shape.mean()]</span>
<span class="c1"># parameters['1991-2020'] = [model_period3.loc.mean(), model_period3.scale.mean(), model_period3.shape.mean()]</span>

<span class="c1"># parameters = parameters.T</span>
<span class="c1"># parameters.round(4)#.astype('%.2f')</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ef.plot_levels_from_obj(fit_period1,alpha=0.95)</span>
<span class="c1"># ef.plot_levels_from_obj(fit_period2,alpha=0.95,ax=plt.gca(),c='C1')</span>
<span class="c1"># ef.plot_levels_from_obj(fit_period3,alpha=0.95,ax=plt.gca(),c='C2')</span>
<span class="c1"># # plt.xlim(1.5,1000)</span>
<span class="c1"># # plt.ylim(0,None)</span>
<span class="c1"># # plt.semilogx()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="potential-add-on-spatial-analysis">
<h1>Potential add-on: spatial analysis<a class="headerlink" href="#potential-add-on-spatial-analysis" title="Permalink to this headline">Â¶</a></h1>
<p>TBD</p>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "pangeo"
        },
        kernelOptions: {
            kernelName: "pangeo",
            path: "./tutorials/W2D4_ClimateResponse-Extremes&Variability/student"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'pangeo'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="W2D4_Tutorial6.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">&lt;no title&gt;</p>
</div>
</a>
<a class="right-next" href="W2D4_Tutorial8.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">scale as function of time</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Climatematch<br/>
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>