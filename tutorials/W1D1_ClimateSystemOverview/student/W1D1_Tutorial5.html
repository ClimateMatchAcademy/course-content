
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 5: Xarray Data Analysis and Climatology — Climatematch Academy: Computational Climate Science</title>
<!-- Loaded before other Sphinx assets -->
<link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/styles/sphinx-book-theme.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/custom.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<link href="../../../genindex.html" rel="index" title="Index">
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W1D1_Tutorial6.html" rel="next" title="Tutorial 6: Compute and Plot Temperature Anomalies"/>
<link href="W1D1_Tutorial4.html" rel="prev" title="Tutorial 4: Arithmetic and Aggregation Methods"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="None" name="docsearch:language"/>
<!-- Google Analytics -->
</link></link></link></link></link></link></head>
<body data-offset="60" data-spy="scroll" data-target="#bd-toc-nav">
<!-- Checkboxes to toggle the left sidebar -->
<input aria-label="Toggle navigation sidebar" class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<label class="overlay overlay-navbar" for="__navigation">
<div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input aria-label="Toggle in-page Table of Contents" class="sidebar-toggle" id="__page-toc" name="__page-toc" type="checkbox"/>
<label class="overlay overlay-pagetoc" for="__page-toc">
<div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
<div class="bd-sidebar__content">
<div class="bd-sidebar__top"><div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<h1 class="site-logo" id="site-title">Climatematch Academy: Computational Climate Science</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../TechnicalHelp/tech_intro.html">
   Technical Help
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2 has-children">
<a class="reference internal" href="../../TechnicalHelp/Jupyterbook.html">
     Using jupyterbook
    </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox">
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_colab.html">
       Using Google Colab
      </a>
</li>
<li class="toctree-l3">
<a class="reference internal" href="../../TechnicalHelp/Tutorial_kaggle.html">
       Using Kaggle
      </a>
</li>
</ul>
</input></li>
<li class="toctree-l2">
<a class="reference internal" href="../../TechnicalHelp/Discord.html">
     Using discord
    </a>
</li>
</ul>
</input></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../TechnicalHelp/Links_Policy.html">
   Quick links and policies
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Fundamentals
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Climate System Overview (W1D1)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox">
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="W1D1_Tutorial1.html">
<strong>
      Tutorial 1: Creating DataArrays and Datasets to Assess Global Climate Data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W1D1_Tutorial2.html">
<strong>
      Tutorial 2: Selection, Interpolation and Slicing
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W1D1_Tutorial3.html">
<strong>
      Tutorial 3: Opening and Plotting netCDF Data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W1D1_Tutorial4.html">
<strong>
      Tutorial 4: Arithmetic and Aggregation Methods
     </strong>
</a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
<strong>
      Tutorial 5: Xarray Data Analysis and Climatology
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W1D1_Tutorial6.html">
<strong>
      Tutorial 6: Compute and Plot Temperature Anomalies
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W1D1_Tutorial7.html">
<strong>
      Tutorial 7: Other Computational Tools in Xarray
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W1D1_Tutorial8.html">
<strong>
      Tutorial 8: Masking with One Condition
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W1D1_Tutorial9.html">
<strong>
      Tutorial 9: Masking with Multiple Conditions
     </strong>
</a>
</li>
</ul>
</input></li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/chapter_title.html">
   Good Research Practices (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial1.html">
<strong>
      Tutorial 1: Finding a Phenomenon and Asking a Question About It
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial2.html">
<strong>
      Tutorial 2: Doing a Literature Review
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial3.html">
<strong>
      Tutorial 3: Identifying the Basic Ingredients
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial4.html">
<strong>
      Tutorial 4: Formulating a Hypothesis
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial5.html">
<strong>
      Tutorial 5: Drafting the Analysis
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial6.html">
<strong>
      Tutorial 6: Implementing the Analysis
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial7.html">
<strong>
      Tutorial 7: Interpreting the Results
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_GoodResearchPractices/student/W2D2_Tutorial8.html">
<strong>
      Tutorial 8: Communicating Your Conclusions
     </strong>
</a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Climate Data
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/chapter_title.html">
   State of the Climate Ocean and Atmosphere Reanalysis (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial1.html">
     Calculating ENSO with Xarray
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial2.html">
     Tutorial 2: A lot of weather makes climate - exploring the ERA5 Reanalysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial3.html">
     Tutorial 3: Atmospheric wind driven circulation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial4.html">
     Tutorial 4: Ocean wind driven circulation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial5.html">
     Tutorial 5: Thermohaline circulation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_StateoftheClimateOceanandAtmosphereReanalysis/student/W1D2_Tutorial6.html">
     Tutorial 6: Ocean heat content
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/chapter_title.html">
   Remote Sensing Land Ocean and Atmosphere (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial1.html">
     Video 1: What is Remote Sensing
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial2.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial3.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial4.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial5.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial6.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial7.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_RemoteSensingLandOceanandAtmosphere/student/W1D3_Tutorial8.html">
     Figure settings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_Paleoclimate/chapter_title.html">
   Paleoclimate (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial1.html">
<strong>
      Tutorial 1: Paleoclimate Proxies
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial2.html">
<strong>
      Tutorial 2: Reconstructing Past Changes in Ocean Climate
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial3.html">
<strong>
      Tutorial 3: Reconstructing Past Changes in Terrestrial Climate
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial4.html">
<strong>
      Tutorial 4: Reconstructing Past Changes in Atmospheric Climate
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial5.html">
<strong>
      Tutorial 5: Paleoclimate Data Analysis Tools
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial6.html">
<strong>
      Tutorial 6: Spectral Analysis of Paleoclimate Data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial7.html">
<strong>
      Tutorial 7: Assessing Climate Forcings
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial8.html">
<strong>
      Tutorial 8: Paleoclimate Models
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_Paleoclimate/student/W1D4_Tutorial9.html">
<strong>
      Tutorial 9: Paleoclimate Reanalysis Products
     </strong>
</a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Climate Future
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_ClimateModeling/chapter_title.html">
   Climate Modeling (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial1.html">
     Setup
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial2.html">
     Setup
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial3.html">
     Setup
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial4.html">
     Setup
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial5.html">
<strong>
      Tutorial 5: Radiative Equilibrium
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial6.html">
<strong>
      Tutorial 6: Radiative Convective Equilibrium
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_ClimateModeling/student/W1D5_Tutorial7.html">
<strong>
      Tutorial 7: Introduction to Earth System Models
     </strong>
</a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/chapter_title.html">
   Future Climate - IPCC I Physical Basis (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial1.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial2.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial3.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial4.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial5.html">
     Figure settings
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_FutureClimate-IPCCIPhysicalBasis/student/W2D1_Tutorial6.html">
     Figure settings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/chapter_title.html">
   Future Climate - IPCC II &amp; III Socio-Economic Basis (W2D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/student/W2D3_Tutorial1.html">
     Tutorial 1 - Limits to growth in World3: A toy world model of diminishing non-renewable resources
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/student/W2D3_Tutorial2.html">
     Tutorial 2 - A first look at integrated assessment models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D3_FutureClimate-IPCCII%26IIISocio-EconomicBasis/student/W2D3_Tutorial4.html">
     Tutorial 4 - Text analysis of COP tweets
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Climate Response
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/chapter_title.html">
   Climate Response - Adaptation Impact (W2D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial1.html">
<strong>
      Tutorial 1: Linear and Logistic Regression
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial2.html">
     Tutorial 2:  Regression and Decision Trees on the Dengue Fever Dataset
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial3.html">
     Tutorial 3:  Logistic Regression and ANN on the Remote Sensing Crop Dataset
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D5_ClimateResponse-AdaptationImpact/student/W2D5_Tutorial4.html">
     Tutorial 9:  Exploring other applications
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Project Booklet
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/README.html">
   Introduction
  </a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="../../../projects/docs/continuing_your_project_after_the_course.html">
   Climatematch Impact Scholars program
  </a>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../../projects/docs/project_guidance.html">
   Daily guide for projects
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/ENSO_impact_on_precipitation_and_temperature.html">
<strong>
      The impact of ENSO on precipitation and temperature
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Ocean_acidification.html">
<strong>
      Ocean acidification
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Wildfires_and_burnt_areas.html">
<strong>
      Monitoring and mapping wildfires using satellite data
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Regional_precipitation_variability.html">
<strong>
      Regional precipitation variability and extreme events
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Heatwaves.html">
<strong>
      Heatwaves: Assessing the dynamic interactions of the atmosphere and land
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Surface_albedo_and_land_use.html">
<strong>
      Change in Earth’s albedo and its dependence on land cover changes in the past 20 years
     </strong>
</a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../../projects/project-notebooks/Sea_level_rise.html">
<strong>
      Sea level rise
     </strong>
</a>
</li>
</ul>
</li>
</ul>
</div>
</nav></div>
<div class="bd-sidebar__bottom">
<!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
</div>
<div id="rtd-footer-container"></div>
</div>
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
<div class="header-article row sticky-top noprint">
<div class="col py-1 d-flex header-article-main">
<div class="header-article__left">
<label class="headerbtn" data-placement="right" data-toggle="tooltip" for="__navigation" title="Toggle navigation">
<span class="headerbtn__icon-container">
<i class="fas fa-bars"></i>
</span>
</label>
</div>
<div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
<button aria-label="Launch interactive content" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-rocket"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://climatematch.2i2c.cloud/hub/user-redirect/git-pull?repo=https%3A//github.com/ClimatematchAcademy/course-content&amp;urlpath=lab/tree/course-content/book/tutorials/W1D1_ClimateSystemOverview/student/W1D1_Tutorial5.ipynb&amp;branch=main" title="Launch on JupyterHub">
<span class="headerbtn__icon-container">
<img src="../../../_static/images/logo_jupyterhub.svg"/>
</span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>
</li>
</ul>
</div>
</div>
<button class="headerbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="headerbtn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<div class="menu-dropdown menu-dropdown-repository-buttons">
<button aria-label="Source repositories" class="headerbtn menu-dropdown__trigger">
<i class="fab fa-github"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/ClimatematchAcademy/course-content" title="Source repository">
<span class="headerbtn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="headerbtn__text-container">repository</span>
</a>
</li>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="https://github.com/ClimatematchAcademy/course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W1D1_ClimateSystemOverview/student/W1D1_Tutorial5.html&amp;body=Your%20issue%20content%20here." title="Open an issue">
<span class="headerbtn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="headerbtn__text-container">open issue</span>
</a>
</li>
</ul>
</div>
</div>
<div class="menu-dropdown menu-dropdown-download-buttons">
<button aria-label="Download this page" class="headerbtn menu-dropdown__trigger">
<i class="fas fa-download"></i>
</button>
<div class="menu-dropdown__content">
<ul>
<li>
<a class="headerbtn" data-placement="left" data-toggle="tooltip" href="../../../_sources/tutorials/W1D1_ClimateSystemOverview/student/W1D1_Tutorial5.ipynb" title="Download source file">
<span class="headerbtn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="headerbtn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="headerbtn" data-placement="left" data-toggle="tooltip" onclick="printPdf(this)" title="Print to PDF">
<span class="headerbtn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="headerbtn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
</div>
<label class="headerbtn headerbtn-page-toc" for="__page-toc">
<span class="headerbtn__icon-container">
<i class="fas fa-list"></i>
</span>
</label>
</div>
</div>
<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
    </div>
<nav aria-label="Page" id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
<strong>
    Tutorial 5: Xarray Data Analysis and Climatology
   </strong>
</a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
<strong>
    Tutorial Objectives
   </strong>
</a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
<strong>
    Setup
   </strong>
</a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
       Figure Settings
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
         Figure Settings
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
           Figure Settings
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
             Figure Settings
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-video-title">
     Video 1: Video Title
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id5">
       Video 1: Video Title
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id6">
         Video 1: Video Title
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id7">
           Video 1: Video Title
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id8">
             Video 1: Video Title
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-groupby-split-apply-combine">
<strong>
    Section 1: GroupBy: Split, Apply, Combine
   </strong>
</a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-split">
<strong>
      Section 1.1: Split
     </strong>
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-apply-combine">
<strong>
      Section 1.2: Apply &amp; Combine
     </strong>
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-1-compute-the-climatology">
<strong>
        Section 1.2.1: Compute the Climatology
       </strong>
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#questions-1-2-1-climate-connection">
<strong>
          Questions 1.2.1: Climate Connection
         </strong>
</a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-2-spatial-variations">
<strong>
        Section 1.2.2: Spatial Variations
       </strong>
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id9">
<strong>
          Questions 1.2.1: Climate Connection
         </strong>
</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
<strong>
    Summary
   </strong>
</a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#resources">
<strong>
    Resources
   </strong>
</a>
</li>
</ul>
</nav>
</div>
</div>
<div class="article row">
<div class="col pl-md-3 pl-lg-5 content-container">
<!-- Table of contents that is only displayed when printing the page -->
<div class="onlyprint" id="jb-print-docs-body">
<h1>Tutorial 5: Xarray Data Analysis and Climatology</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
<strong>
    Tutorial 5: Xarray Data Analysis and Climatology
   </strong>
</a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
<strong>
    Tutorial Objectives
   </strong>
</a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
<strong>
    Setup
   </strong>
</a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
       Figure Settings
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
         Figure Settings
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
           Figure Settings
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
             Figure Settings
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-video-title">
     Video 1: Video Title
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id5">
       Video 1: Video Title
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id6">
         Video 1: Video Title
        </a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#id7">
           Video 1: Video Title
          </a>
<ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry">
<a class="reference internal nav-link" href="#id8">
             Video 1: Video Title
            </a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-groupby-split-apply-combine">
<strong>
    Section 1: GroupBy: Split, Apply, Combine
   </strong>
</a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-1-split">
<strong>
      Section 1.1: Split
     </strong>
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-apply-combine">
<strong>
      Section 1.2: Apply &amp; Combine
     </strong>
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-1-compute-the-climatology">
<strong>
        Section 1.2.1: Compute the Climatology
       </strong>
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#questions-1-2-1-climate-connection">
<strong>
          Questions 1.2.1: Climate Connection
         </strong>
</a>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-2-2-spatial-variations">
<strong>
        Section 1.2.2: Spatial Variations
       </strong>
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id9">
<strong>
          Questions 1.2.1: Climate Connection
         </strong>
</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
<strong>
    Summary
   </strong>
</a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#resources">
<strong>
    Resources
   </strong>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<main id="main-content" role="main">
<div>
<div class="section" id="tutorial-5-xarray-data-analysis-and-climatology">
<h1><strong>Tutorial 5: Xarray Data Analysis and Climatology</strong><a class="headerlink" href="#tutorial-5-xarray-data-analysis-and-climatology" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 1, Day 1, Climate System Overview</strong></p>
<p><strong>Content creators:</strong> Sloane Garelick, Julia Kent</p>
<p><strong>Content reviewers:</strong> Katrina Dobson, Younkap Nina Duplex, Danika Gupta, Maria Gonzalez, Will Gregory, Nahid Hasan, Sherry Mi, Beatriz Cosenza Muralles, Jenna Pearson, Agustina Pesce, Chi Zhang, Ohad Zivan</p>
<p><strong>Content editors:</strong> Jenna Pearson, Chi Zhang, Ohad Zivan</p>
<p><strong>Production editors:</strong> Wesley Banfield, Jenna Pearson, Chi Zhang, Ohad Zivan</p>
<p><strong>Our 2023 Sponsors:</strong> NASA TOPS</p>
</div>
<div class="section" id="tutorial-objectives">
<h1><strong>Tutorial Objectives</strong><a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p>Global climate can vary on long timescales, but it’s also important to understand seasonal variations. For example, seasonal variations in precipitation associated with the migration of the <a class="reference external" href="https://glossary.ametsoc.org/wiki/Intertropical_convergence_zone#:~:text=(Also%20called%20ITCZ%2C%20equatorial%20convergence,and%20Northern%20Hemispheres%2C%20respectively).">Intertropical Convergence Zone (ITCZ)</a> and monsoon systems occur in response to seasonal changes in temperature. In this tutorial, we will use data analysis tools in Xarray to explore the seasonal climatology of global temperature. Specifically, in this tutorial, we’ll use the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> operation in Xarray, which involves the following steps:</p>
<ul class="simple">
<li><p><strong>Split</strong>: group data by value (e.g., month).</p></li>
<li><p><strong>Apply</strong>: compute some function (e.g., aggregate) within the individual groups.</p></li>
<li><p><strong>Combine</strong>: merge the results of these operations into an output dataset.</p></li>
</ul>
</div>
<div class="section" id="setup">
<h1><strong>Setup</strong><a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># imports</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">pythia_datasets</span> <span class="kn">import</span> <span class="n">DATASETS</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure Settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Figure Settings<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id2">
<h4>Figure Settings<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id3">
<h5>Figure Settings<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<div class="section" id="id4">
<h6>Figure Settings<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h6>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure Settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>       <span class="c1"># interactive display</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/ClimateMatchAcademy/course-content/main/cma.mplstyle"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="video-1-video-title">
<h2>Video 1: Video Title<a class="headerlink" href="#video-1-video-title" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id5">
<h3>Video 1: Video Title<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id6">
<h4>Video 1: Video Title<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id7">
<h5>Video 1: Video Title<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h5>
<div class="section" id="id8">
<h6>Video 1: Video Title<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h6>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Video 1: Video Title</span>
<span class="c1">#Tech team will add code to format and display the video</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="section-1-groupby-split-apply-combine">
<h1><strong>Section 1: GroupBy: Split, Apply, Combine</strong><a class="headerlink" href="#section-1-groupby-split-apply-combine" title="Permalink to this headline">¶</a></h1>
<p>Simple aggregations (as we learned in the previous tutorial) can give useful summary of our dataset, but often we would prefer to aggregate conditionally on some coordinate labels or groups. Xarray provides the so-called <code class="docutils literal notranslate"><span class="pre">groupby</span></code> operation which enables the <strong>split-apply-combine</strong> workflow on Xarray DataArrays and Datasets. The split-apply-combine operation is illustrated in this figure from <a class="reference external" href="https://foundations.projectpythia.org/core/xarray/computation-masking.html">Project Pythia</a>:</p>
<p><img alt="image.png" src="tutorials/W1D1_ClimateSystemOverview/student/attachment:image.png"/></p>
<ul class="simple">
<li><p>The <strong>split</strong> step involves breaking up and grouping an xarray Dataset or DataArray depending on the value of the specified group key.</p></li>
<li><p>The <strong>apply</strong> step involves computing some function, usually an aggregate, transformation, or filtering, within the individual groups.</p></li>
<li><p>The <strong>combine</strong> step merges the results of these operations into an output xarray Dataset or DataArray.</p></li>
</ul>
<p>We are going to use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> to remove the seasonal cycle (“climatology”) from our dataset, which will allow us to better observe long-term trends in the data. See the <a class="reference external" href="https://xarray.pydata.org/en/stable/user-guide/groupby.html">xarray <code class="docutils literal notranslate"><span class="pre">groupby</span></code> user guide</a> for more examples of what <code class="docutils literal notranslate"><span class="pre">groupby</span></code> can take as an input.</p>
<p>Let’s start by loading the same data that we used in the previous tutorial (monthly SST data from CESM2):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filepath</span> <span class="o">=</span> <span class="n">DATASETS</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">'CESM2_sst_data.nc'</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
</div>
<p>Then, let’s select a gridpoint closest to a specified lat-lon (in this case let’s select 50ºN, 310ºE), and plot a time series of SST at that point (recall that we learned this is Tutorial 2). The annual cycle will be quite pronounced. Note that we are using the <code class="docutils literal notranslate"><span class="pre">nearest</span></code> method (see Tutorial 2 for a refresher) to find the points in our datasets closest to the lat-lon values we specify. What this returns may not match these inputs exactly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">tos</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="mi">310</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span> <span class="c1">#time range is 2000-01-15 to 2014-12-15</span>
</pre></div>
</div>
</div>
</div>
<p>This plot is showing changes in monthly SST between 2000-01-15 to 2014-12-15. The annual cycle of SST change is apparent in this figure, but to understand the climatatology of this region, we need to calculate the average SST for each month over this time period. The first step is to split the data into groups based on month.</p>
<div class="section" id="section-1-1-split">
<h2><strong>Section 1.1: Split</strong><a class="headerlink" href="#section-1-1-split" title="Permalink to this headline">¶</a></h2>
<p>Let’s group data by month, i.e. all Januaries in one group, all Februaries in one group, etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">tos</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition alert alert-info">
<p>In the above code, we are using the <code class="docutils literal notranslate"><span class="pre">.dt</span></code> <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.core.accessor_dt.DatetimeAccessor.html"><code class="docutils literal notranslate"><span class="pre">DatetimeAccessor</span></code></a> to extract specific components of dates/times in our time coordinate dimension. For example, we can extract the year with <code class="docutils literal notranslate"><span class="pre">ds.time.dt.year</span></code>. See also the equivalent <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.dt.html">Pandas documentation</a>.</p>
</div><p>Xarray also offers a more concise syntax when the variable you’re grouping on is already present in the dataset. This is identical to <code class="docutils literal notranslate"><span class="pre">ds.tos.groupby(ds.time.dt.month)</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">tos</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'time.month'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="section-1-2-apply-combine">
<h2><strong>Section 1.2: Apply &amp; Combine</strong><a class="headerlink" href="#section-1-2-apply-combine" title="Permalink to this headline">¶</a></h2>
<p>Now that we have groups defined, it’s time to “apply” a calculation to the group. These calculations can either be:</p>
<ul class="simple">
<li><p>aggregation: reduces the size of the group</p></li>
<li><p>transformation: preserves the group’s full size</p></li>
</ul>
<p>At then end of the apply step, xarray will automatically combine the aggregated/transformed groups back into a single object.</p>
<div class="section" id="section-1-2-1-compute-the-climatology">
<h3><strong>Section 1.2.1: Compute the Climatology</strong><a class="headerlink" href="#section-1-2-1-compute-the-climatology" title="Permalink to this headline">¶</a></h3>
<p>Let’s calculate the climatology at every point in the dataset. To do so, we will use aggregation and will calculate the mean SST for each month:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tos_clim</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">tos</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'time.month'</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">tos_clim</span>
</pre></div>
</div>
</div>
</div>
<p>For every spatial coordinate, we now have a monthly mean SST for the time period 2000-01-15 to 2014-12-15.</p>
<p>We can now plot the climatology at a specific point:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tos_clim</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="mi">310</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<p>Based on this plot, the climatology of this location is defined by cooler SST from December to April and warmer SST from June to October, with an annual SST range of ~8ºC.</p>
<div class="section" id="questions-1-2-1-climate-connection">
<h4><strong>Questions 1.2.1: Climate Connection</strong><a class="headerlink" href="#questions-1-2-1-climate-connection" title="Permalink to this headline">¶</a></h4>
<ol class="simple">
<li><p>Considering the latitude and longitude of this data, can you explain why we observe this climatology?</p></li>
<li><p>How do you think seasonal variations in SST would differ at the equator? What about at the poles? What about at 50ºS?</p></li>
</ol>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/main/tutorials/W1D1_ClimateSystemOverview/solutions/W1D1_Tutorial5_Solution_c7a854ea.py"><em>Click for solution</em></a></p>
</div>
</div>
<div class="section" id="section-1-2-2-spatial-variations">
<h3><strong>Section 1.2.2: Spatial Variations</strong><a class="headerlink" href="#section-1-2-2-spatial-variations" title="Permalink to this headline">¶</a></h3>
<p>We can now add a spatial dimension to this plot and look at the zonal mean climatology (the monthly mean SST at different latitudes):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tos_clim</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">'lon'</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'turbo'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>This gives us helpful information about the mean SST for each month, but it’s difficult to asses the range of monthly temperatures throughout the year using this plot.</p>
<p>To better represent the range of SST, we can calculate and plot the difference between January and July climatologies:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">tos_clim</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">tos_clim</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="mi">7</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id9">
<h4><strong>Questions 1.2.1: Climate Connection</strong><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<ol class="simple">
<li><p>What patterns do you observe in this map?</p></li>
<li><p>Why is there such an apparent difference between the Northern and Southern Hemisphere SST changes?</p></li>
<li><p>How does the migration of the ITCZ relate to seasonal changes in Northern vs. Southern Hemisphere temperatures?</p></li>
</ol>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/main/tutorials/W1D1_ClimateSystemOverview/solutions/W1D1_Tutorial5_Solution_3a74bea8.py"><em>Click for solution</em></a></p>
</div>
</div>
</div>
</div>
<div class="section" id="summary">
<h1><strong>Summary</strong><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial, we focused on exploring seasonal climatology in global temperature data using the split-apply-combine approach in Xarray. By utilizing the split-apply-combine approach, we gained insights into the seasonal climatology of temperature and precipitation data, enabling us to analyze and understand the seasonal variations associated with global climate patterns.</p>
</div>
<div class="section" id="resources">
<h1><strong>Resources</strong><a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h1>
<p>Code and data for this tutorial is based on existing content from <a class="reference external" href="https://foundations.projectpythia.org/core/xarray/computation-masking.html">Project Pythia</a>.</p>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "climatematch"
        },
        kernelOptions: {
            kernelName: "climatematch",
            path: "./tutorials/W1D1_ClimateSystemOverview/student"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'climatematch'</script>
</div>
</main>
<footer class="footer-article noprint">
<!-- Previous / next buttons -->
<div class="prev-next-area">
<a class="left-prev" href="W1D1_Tutorial4.html" id="prev-link" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title"><strong>Tutorial 4: Arithmetic and Aggregation Methods</strong></p>
</div>
</a>
<a class="right-next" href="W1D1_Tutorial6.html" id="next-link" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title"><strong>Tutorial 6: Compute and Plot Temperature Anomalies</strong></p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
</div>
<div class="footer-content row">
<footer class="col footer"><p>
  
    By Climatematch<br/>
<div class="extra_footer">
<div>
<a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png"/></a>
<a href="https://opensource.org/licenses/BSD-3-Clause"><img src="https://camo.githubusercontent.com/9b9ea65d95c9ef878afa1987df65731d47681336/68747470733a2f2f696d672e736869656c64732e696f2f707970692f6c2f736561626f726e2e737667"/></a>
The contents of this repository are shared under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
Software elements are additionally licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">BSD (3-Clause) License</a>.
</div>
</div>
</p>
</footer>
</div>
</div>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
</body>
</html>